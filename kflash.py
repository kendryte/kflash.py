#!/usr/bin/env python3
# -*- coding: utf-8 -*-
import sys
import time
import zlib
import copy
import struct
from enum import Enum
import binascii
import hashlib
import argparse
import math
import zipfile, tempfile
import json
import re
import os

BASH_TIPS = dict(NORMAL='\033[0m',BOLD='\033[1m',DIM='\033[2m',UNDERLINE='\033[4m',
                    DEFAULT='\033[0m', RED='\033[31m', YELLOW='\033[33m', GREEN='\033[32m',
                    BG_DEFAULT='\033[49m', BG_WHITE='\033[107m')

ERROR_MSG   = BASH_TIPS['RED']+BASH_TIPS['BOLD']+'[ERROR]'+BASH_TIPS['NORMAL']
WARN_MSG    = BASH_TIPS['YELLOW']+BASH_TIPS['BOLD']+'[WARN]'+BASH_TIPS['NORMAL']
INFO_MSG    = BASH_TIPS['GREEN']+BASH_TIPS['BOLD']+'[INFO]'+BASH_TIPS['NORMAL']

VID_LIST_FOR_AUTO_LOOKUP = "(1A86)|(0403)|(067B)|(10C4)|(C251)|(0403)"
#                            WCH    FTDI    PL     CL    DAP   OPENEC
timeout = 0.5

MAX_RETRY_TIMES = 10

ISP_FLASH_SECTOR_SIZE = 4096
ISP_FLASH_DATA_FRAME_SIZE = ISP_FLASH_SECTOR_SIZE * 16

class TimeoutError(Exception): pass

class ProgramFileFormat(Enum):
    FMT_BINARY = 0
    FMT_ELF = 1
    FMT_KFPKG = 2

try:
    import serial
    import serial.tools.list_ports
except ImportError:
    print(ERROR_MSG,'PySerial must be installed, run '+BASH_TIPS['GREEN']+'`pip3 install pyserial`',BASH_TIPS['DEFAULT'])
    sys.exit(1)

# AES is from: https://github.com/ricmoo/pyaes, Copyright by Richard Moore
class AES:
    '''Encapsulates the AES block cipher.
    You generally should not need this. Use the AESModeOfOperation classes
    below instead.'''
    @staticmethod
    def _compact_word(word):
        return (word[0] << 24) | (word[1] << 16) | (word[2] << 8) | word[3]

    # Number of rounds by keysize
    number_of_rounds = {16: 10, 24: 12, 32: 14}

    # Round constant words
    rcon = [ 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1b, 0x36, 0x6c, 0xd8, 0xab, 0x4d, 0x9a, 0x2f, 0x5e, 0xbc, 0x63, 0xc6, 0x97, 0x35, 0x6a, 0xd4, 0xb3, 0x7d, 0xfa, 0xef, 0xc5, 0x91 ]

    # S-box and Inverse S-box (S is for Substitution)
    S = [ 0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76, 0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0, 0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15, 0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75, 0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84, 0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf, 0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8, 0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2, 0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73, 0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb, 0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79, 0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08, 0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a, 0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e, 0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf, 0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16 ]
    Si =[ 0x52, 0x09, 0x6a, 0xd5, 0x30, 0x36, 0xa5, 0x38, 0xbf, 0x40, 0xa3, 0x9e, 0x81, 0xf3, 0xd7, 0xfb, 0x7c, 0xe3, 0x39, 0x82, 0x9b, 0x2f, 0xff, 0x87, 0x34, 0x8e, 0x43, 0x44, 0xc4, 0xde, 0xe9, 0xcb, 0x54, 0x7b, 0x94, 0x32, 0xa6, 0xc2, 0x23, 0x3d, 0xee, 0x4c, 0x95, 0x0b, 0x42, 0xfa, 0xc3, 0x4e, 0x08, 0x2e, 0xa1, 0x66, 0x28, 0xd9, 0x24, 0xb2, 0x76, 0x5b, 0xa2, 0x49, 0x6d, 0x8b, 0xd1, 0x25, 0x72, 0xf8, 0xf6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xd4, 0xa4, 0x5c, 0xcc, 0x5d, 0x65, 0xb6, 0x92, 0x6c, 0x70, 0x48, 0x50, 0xfd, 0xed, 0xb9, 0xda, 0x5e, 0x15, 0x46, 0x57, 0xa7, 0x8d, 0x9d, 0x84, 0x90, 0xd8, 0xab, 0x00, 0x8c, 0xbc, 0xd3, 0x0a, 0xf7, 0xe4, 0x58, 0x05, 0xb8, 0xb3, 0x45, 0x06, 0xd0, 0x2c, 0x1e, 0x8f, 0xca, 0x3f, 0x0f, 0x02, 0xc1, 0xaf, 0xbd, 0x03, 0x01, 0x13, 0x8a, 0x6b, 0x3a, 0x91, 0x11, 0x41, 0x4f, 0x67, 0xdc, 0xea, 0x97, 0xf2, 0xcf, 0xce, 0xf0, 0xb4, 0xe6, 0x73, 0x96, 0xac, 0x74, 0x22, 0xe7, 0xad, 0x35, 0x85, 0xe2, 0xf9, 0x37, 0xe8, 0x1c, 0x75, 0xdf, 0x6e, 0x47, 0xf1, 0x1a, 0x71, 0x1d, 0x29, 0xc5, 0x89, 0x6f, 0xb7, 0x62, 0x0e, 0xaa, 0x18, 0xbe, 0x1b, 0xfc, 0x56, 0x3e, 0x4b, 0xc6, 0xd2, 0x79, 0x20, 0x9a, 0xdb, 0xc0, 0xfe, 0x78, 0xcd, 0x5a, 0xf4, 0x1f, 0xdd, 0xa8, 0x33, 0x88, 0x07, 0xc7, 0x31, 0xb1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xec, 0x5f, 0x60, 0x51, 0x7f, 0xa9, 0x19, 0xb5, 0x4a, 0x0d, 0x2d, 0xe5, 0x7a, 0x9f, 0x93, 0xc9, 0x9c, 0xef, 0xa0, 0xe0, 0x3b, 0x4d, 0xae, 0x2a, 0xf5, 0xb0, 0xc8, 0xeb, 0xbb, 0x3c, 0x83, 0x53, 0x99, 0x61, 0x17, 0x2b, 0x04, 0x7e, 0xba, 0x77, 0xd6, 0x26, 0xe1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0c, 0x7d ]

    # Transformations for encryption
    T1 = [ 0xc66363a5, 0xf87c7c84, 0xee777799, 0xf67b7b8d, 0xfff2f20d, 0xd66b6bbd, 0xde6f6fb1, 0x91c5c554, 0x60303050, 0x02010103, 0xce6767a9, 0x562b2b7d, 0xe7fefe19, 0xb5d7d762, 0x4dababe6, 0xec76769a, 0x8fcaca45, 0x1f82829d, 0x89c9c940, 0xfa7d7d87, 0xeffafa15, 0xb25959eb, 0x8e4747c9, 0xfbf0f00b, 0x41adadec, 0xb3d4d467, 0x5fa2a2fd, 0x45afafea, 0x239c9cbf, 0x53a4a4f7, 0xe4727296, 0x9bc0c05b, 0x75b7b7c2, 0xe1fdfd1c, 0x3d9393ae, 0x4c26266a, 0x6c36365a, 0x7e3f3f41, 0xf5f7f702, 0x83cccc4f, 0x6834345c, 0x51a5a5f4, 0xd1e5e534, 0xf9f1f108, 0xe2717193, 0xabd8d873, 0x62313153, 0x2a15153f, 0x0804040c, 0x95c7c752, 0x46232365, 0x9dc3c35e, 0x30181828, 0x379696a1, 0x0a05050f, 0x2f9a9ab5, 0x0e070709, 0x24121236, 0x1b80809b, 0xdfe2e23d, 0xcdebeb26, 0x4e272769, 0x7fb2b2cd, 0xea75759f, 0x1209091b, 0x1d83839e, 0x582c2c74, 0x341a1a2e, 0x361b1b2d, 0xdc6e6eb2, 0xb45a5aee, 0x5ba0a0fb, 0xa45252f6, 0x763b3b4d, 0xb7d6d661, 0x7db3b3ce, 0x5229297b, 0xdde3e33e, 0x5e2f2f71, 0x13848497, 0xa65353f5, 0xb9d1d168, 0x00000000, 0xc1eded2c, 0x40202060, 0xe3fcfc1f, 0x79b1b1c8, 0xb65b5bed, 0xd46a6abe, 0x8dcbcb46, 0x67bebed9, 0x7239394b, 0x944a4ade, 0x984c4cd4, 0xb05858e8, 0x85cfcf4a, 0xbbd0d06b, 0xc5efef2a, 0x4faaaae5, 0xedfbfb16, 0x864343c5, 0x9a4d4dd7, 0x66333355, 0x11858594, 0x8a4545cf, 0xe9f9f910, 0x04020206, 0xfe7f7f81, 0xa05050f0, 0x783c3c44, 0x259f9fba, 0x4ba8a8e3, 0xa25151f3, 0x5da3a3fe, 0x804040c0, 0x058f8f8a, 0x3f9292ad, 0x219d9dbc, 0x70383848, 0xf1f5f504, 0x63bcbcdf, 0x77b6b6c1, 0xafdada75, 0x42212163, 0x20101030, 0xe5ffff1a, 0xfdf3f30e, 0xbfd2d26d, 0x81cdcd4c, 0x180c0c14, 0x26131335, 0xc3ecec2f, 0xbe5f5fe1, 0x359797a2, 0x884444cc, 0x2e171739, 0x93c4c457, 0x55a7a7f2, 0xfc7e7e82, 0x7a3d3d47, 0xc86464ac, 0xba5d5de7, 0x3219192b, 0xe6737395, 0xc06060a0, 0x19818198, 0x9e4f4fd1, 0xa3dcdc7f, 0x44222266, 0x542a2a7e, 0x3b9090ab, 0x0b888883, 0x8c4646ca, 0xc7eeee29, 0x6bb8b8d3, 0x2814143c, 0xa7dede79, 0xbc5e5ee2, 0x160b0b1d, 0xaddbdb76, 0xdbe0e03b, 0x64323256, 0x743a3a4e, 0x140a0a1e, 0x924949db, 0x0c06060a, 0x4824246c, 0xb85c5ce4, 0x9fc2c25d, 0xbdd3d36e, 0x43acacef, 0xc46262a6, 0x399191a8, 0x319595a4, 0xd3e4e437, 0xf279798b, 0xd5e7e732, 0x8bc8c843, 0x6e373759, 0xda6d6db7, 0x018d8d8c, 0xb1d5d564, 0x9c4e4ed2, 0x49a9a9e0, 0xd86c6cb4, 0xac5656fa, 0xf3f4f407, 0xcfeaea25, 0xca6565af, 0xf47a7a8e, 0x47aeaee9, 0x10080818, 0x6fbabad5, 0xf0787888, 0x4a25256f, 0x5c2e2e72, 0x381c1c24, 0x57a6a6f1, 0x73b4b4c7, 0x97c6c651, 0xcbe8e823, 0xa1dddd7c, 0xe874749c, 0x3e1f1f21, 0x964b4bdd, 0x61bdbddc, 0x0d8b8b86, 0x0f8a8a85, 0xe0707090, 0x7c3e3e42, 0x71b5b5c4, 0xcc6666aa, 0x904848d8, 0x06030305, 0xf7f6f601, 0x1c0e0e12, 0xc26161a3, 0x6a35355f, 0xae5757f9, 0x69b9b9d0, 0x17868691, 0x99c1c158, 0x3a1d1d27, 0x279e9eb9, 0xd9e1e138, 0xebf8f813, 0x2b9898b3, 0x22111133, 0xd26969bb, 0xa9d9d970, 0x078e8e89, 0x339494a7, 0x2d9b9bb6, 0x3c1e1e22, 0x15878792, 0xc9e9e920, 0x87cece49, 0xaa5555ff, 0x50282878, 0xa5dfdf7a, 0x038c8c8f, 0x59a1a1f8, 0x09898980, 0x1a0d0d17, 0x65bfbfda, 0xd7e6e631, 0x844242c6, 0xd06868b8, 0x824141c3, 0x299999b0, 0x5a2d2d77, 0x1e0f0f11, 0x7bb0b0cb, 0xa85454fc, 0x6dbbbbd6, 0x2c16163a ]
    T2 = [ 0xa5c66363, 0x84f87c7c, 0x99ee7777, 0x8df67b7b, 0x0dfff2f2, 0xbdd66b6b, 0xb1de6f6f, 0x5491c5c5, 0x50603030, 0x03020101, 0xa9ce6767, 0x7d562b2b, 0x19e7fefe, 0x62b5d7d7, 0xe64dabab, 0x9aec7676, 0x458fcaca, 0x9d1f8282, 0x4089c9c9, 0x87fa7d7d, 0x15effafa, 0xebb25959, 0xc98e4747, 0x0bfbf0f0, 0xec41adad, 0x67b3d4d4, 0xfd5fa2a2, 0xea45afaf, 0xbf239c9c, 0xf753a4a4, 0x96e47272, 0x5b9bc0c0, 0xc275b7b7, 0x1ce1fdfd, 0xae3d9393, 0x6a4c2626, 0x5a6c3636, 0x417e3f3f, 0x02f5f7f7, 0x4f83cccc, 0x5c683434, 0xf451a5a5, 0x34d1e5e5, 0x08f9f1f1, 0x93e27171, 0x73abd8d8, 0x53623131, 0x3f2a1515, 0x0c080404, 0x5295c7c7, 0x65462323, 0x5e9dc3c3, 0x28301818, 0xa1379696, 0x0f0a0505, 0xb52f9a9a, 0x090e0707, 0x36241212, 0x9b1b8080, 0x3ddfe2e2, 0x26cdebeb, 0x694e2727, 0xcd7fb2b2, 0x9fea7575, 0x1b120909, 0x9e1d8383, 0x74582c2c, 0x2e341a1a, 0x2d361b1b, 0xb2dc6e6e, 0xeeb45a5a, 0xfb5ba0a0, 0xf6a45252, 0x4d763b3b, 0x61b7d6d6, 0xce7db3b3, 0x7b522929, 0x3edde3e3, 0x715e2f2f, 0x97138484, 0xf5a65353, 0x68b9d1d1, 0x00000000, 0x2cc1eded, 0x60402020, 0x1fe3fcfc, 0xc879b1b1, 0xedb65b5b, 0xbed46a6a, 0x468dcbcb, 0xd967bebe, 0x4b723939, 0xde944a4a, 0xd4984c4c, 0xe8b05858, 0x4a85cfcf, 0x6bbbd0d0, 0x2ac5efef, 0xe54faaaa, 0x16edfbfb, 0xc5864343, 0xd79a4d4d, 0x55663333, 0x94118585, 0xcf8a4545, 0x10e9f9f9, 0x06040202, 0x81fe7f7f, 0xf0a05050, 0x44783c3c, 0xba259f9f, 0xe34ba8a8, 0xf3a25151, 0xfe5da3a3, 0xc0804040, 0x8a058f8f, 0xad3f9292, 0xbc219d9d, 0x48703838, 0x04f1f5f5, 0xdf63bcbc, 0xc177b6b6, 0x75afdada, 0x63422121, 0x30201010, 0x1ae5ffff, 0x0efdf3f3, 0x6dbfd2d2, 0x4c81cdcd, 0x14180c0c, 0x35261313, 0x2fc3ecec, 0xe1be5f5f, 0xa2359797, 0xcc884444, 0x392e1717, 0x5793c4c4, 0xf255a7a7, 0x82fc7e7e, 0x477a3d3d, 0xacc86464, 0xe7ba5d5d, 0x2b321919, 0x95e67373, 0xa0c06060, 0x98198181, 0xd19e4f4f, 0x7fa3dcdc, 0x66442222, 0x7e542a2a, 0xab3b9090, 0x830b8888, 0xca8c4646, 0x29c7eeee, 0xd36bb8b8, 0x3c281414, 0x79a7dede, 0xe2bc5e5e, 0x1d160b0b, 0x76addbdb, 0x3bdbe0e0, 0x56643232, 0x4e743a3a, 0x1e140a0a, 0xdb924949, 0x0a0c0606, 0x6c482424, 0xe4b85c5c, 0x5d9fc2c2, 0x6ebdd3d3, 0xef43acac, 0xa6c46262, 0xa8399191, 0xa4319595, 0x37d3e4e4, 0x8bf27979, 0x32d5e7e7, 0x438bc8c8, 0x596e3737, 0xb7da6d6d, 0x8c018d8d, 0x64b1d5d5, 0xd29c4e4e, 0xe049a9a9, 0xb4d86c6c, 0xfaac5656, 0x07f3f4f4, 0x25cfeaea, 0xafca6565, 0x8ef47a7a, 0xe947aeae, 0x18100808, 0xd56fbaba, 0x88f07878, 0x6f4a2525, 0x725c2e2e, 0x24381c1c, 0xf157a6a6, 0xc773b4b4, 0x5197c6c6, 0x23cbe8e8, 0x7ca1dddd, 0x9ce87474, 0x213e1f1f, 0xdd964b4b, 0xdc61bdbd, 0x860d8b8b, 0x850f8a8a, 0x90e07070, 0x427c3e3e, 0xc471b5b5, 0xaacc6666, 0xd8904848, 0x05060303, 0x01f7f6f6, 0x121c0e0e, 0xa3c26161, 0x5f6a3535, 0xf9ae5757, 0xd069b9b9, 0x91178686, 0x5899c1c1, 0x273a1d1d, 0xb9279e9e, 0x38d9e1e1, 0x13ebf8f8, 0xb32b9898, 0x33221111, 0xbbd26969, 0x70a9d9d9, 0x89078e8e, 0xa7339494, 0xb62d9b9b, 0x223c1e1e, 0x92158787, 0x20c9e9e9, 0x4987cece, 0xffaa5555, 0x78502828, 0x7aa5dfdf, 0x8f038c8c, 0xf859a1a1, 0x80098989, 0x171a0d0d, 0xda65bfbf, 0x31d7e6e6, 0xc6844242, 0xb8d06868, 0xc3824141, 0xb0299999, 0x775a2d2d, 0x111e0f0f, 0xcb7bb0b0, 0xfca85454, 0xd66dbbbb, 0x3a2c1616 ]
    T3 = [ 0x63a5c663, 0x7c84f87c, 0x7799ee77, 0x7b8df67b, 0xf20dfff2, 0x6bbdd66b, 0x6fb1de6f, 0xc55491c5, 0x30506030, 0x01030201, 0x67a9ce67, 0x2b7d562b, 0xfe19e7fe, 0xd762b5d7, 0xabe64dab, 0x769aec76, 0xca458fca, 0x829d1f82, 0xc94089c9, 0x7d87fa7d, 0xfa15effa, 0x59ebb259, 0x47c98e47, 0xf00bfbf0, 0xadec41ad, 0xd467b3d4, 0xa2fd5fa2, 0xafea45af, 0x9cbf239c, 0xa4f753a4, 0x7296e472, 0xc05b9bc0, 0xb7c275b7, 0xfd1ce1fd, 0x93ae3d93, 0x266a4c26, 0x365a6c36, 0x3f417e3f, 0xf702f5f7, 0xcc4f83cc, 0x345c6834, 0xa5f451a5, 0xe534d1e5, 0xf108f9f1, 0x7193e271, 0xd873abd8, 0x31536231, 0x153f2a15, 0x040c0804, 0xc75295c7, 0x23654623, 0xc35e9dc3, 0x18283018, 0x96a13796, 0x050f0a05, 0x9ab52f9a, 0x07090e07, 0x12362412, 0x809b1b80, 0xe23ddfe2, 0xeb26cdeb, 0x27694e27, 0xb2cd7fb2, 0x759fea75, 0x091b1209, 0x839e1d83, 0x2c74582c, 0x1a2e341a, 0x1b2d361b, 0x6eb2dc6e, 0x5aeeb45a, 0xa0fb5ba0, 0x52f6a452, 0x3b4d763b, 0xd661b7d6, 0xb3ce7db3, 0x297b5229, 0xe33edde3, 0x2f715e2f, 0x84971384, 0x53f5a653, 0xd168b9d1, 0x00000000, 0xed2cc1ed, 0x20604020, 0xfc1fe3fc, 0xb1c879b1, 0x5bedb65b, 0x6abed46a, 0xcb468dcb, 0xbed967be, 0x394b7239, 0x4ade944a, 0x4cd4984c, 0x58e8b058, 0xcf4a85cf, 0xd06bbbd0, 0xef2ac5ef, 0xaae54faa, 0xfb16edfb, 0x43c58643, 0x4dd79a4d, 0x33556633, 0x85941185, 0x45cf8a45, 0xf910e9f9, 0x02060402, 0x7f81fe7f, 0x50f0a050, 0x3c44783c, 0x9fba259f, 0xa8e34ba8, 0x51f3a251, 0xa3fe5da3, 0x40c08040, 0x8f8a058f, 0x92ad3f92, 0x9dbc219d, 0x38487038, 0xf504f1f5, 0xbcdf63bc, 0xb6c177b6, 0xda75afda, 0x21634221, 0x10302010, 0xff1ae5ff, 0xf30efdf3, 0xd26dbfd2, 0xcd4c81cd, 0x0c14180c, 0x13352613, 0xec2fc3ec, 0x5fe1be5f, 0x97a23597, 0x44cc8844, 0x17392e17, 0xc45793c4, 0xa7f255a7, 0x7e82fc7e, 0x3d477a3d, 0x64acc864, 0x5de7ba5d, 0x192b3219, 0x7395e673, 0x60a0c060, 0x81981981, 0x4fd19e4f, 0xdc7fa3dc, 0x22664422, 0x2a7e542a, 0x90ab3b90, 0x88830b88, 0x46ca8c46, 0xee29c7ee, 0xb8d36bb8, 0x143c2814, 0xde79a7de, 0x5ee2bc5e, 0x0b1d160b, 0xdb76addb, 0xe03bdbe0, 0x32566432, 0x3a4e743a, 0x0a1e140a, 0x49db9249, 0x060a0c06, 0x246c4824, 0x5ce4b85c, 0xc25d9fc2, 0xd36ebdd3, 0xacef43ac, 0x62a6c462, 0x91a83991, 0x95a43195, 0xe437d3e4, 0x798bf279, 0xe732d5e7, 0xc8438bc8, 0x37596e37, 0x6db7da6d, 0x8d8c018d, 0xd564b1d5, 0x4ed29c4e, 0xa9e049a9, 0x6cb4d86c, 0x56faac56, 0xf407f3f4, 0xea25cfea, 0x65afca65, 0x7a8ef47a, 0xaee947ae, 0x08181008, 0xbad56fba, 0x7888f078, 0x256f4a25, 0x2e725c2e, 0x1c24381c, 0xa6f157a6, 0xb4c773b4, 0xc65197c6, 0xe823cbe8, 0xdd7ca1dd, 0x749ce874, 0x1f213e1f, 0x4bdd964b, 0xbddc61bd, 0x8b860d8b, 0x8a850f8a, 0x7090e070, 0x3e427c3e, 0xb5c471b5, 0x66aacc66, 0x48d89048, 0x03050603, 0xf601f7f6, 0x0e121c0e, 0x61a3c261, 0x355f6a35, 0x57f9ae57, 0xb9d069b9, 0x86911786, 0xc15899c1, 0x1d273a1d, 0x9eb9279e, 0xe138d9e1, 0xf813ebf8, 0x98b32b98, 0x11332211, 0x69bbd269, 0xd970a9d9, 0x8e89078e, 0x94a73394, 0x9bb62d9b, 0x1e223c1e, 0x87921587, 0xe920c9e9, 0xce4987ce, 0x55ffaa55, 0x28785028, 0xdf7aa5df, 0x8c8f038c, 0xa1f859a1, 0x89800989, 0x0d171a0d, 0xbfda65bf, 0xe631d7e6, 0x42c68442, 0x68b8d068, 0x41c38241, 0x99b02999, 0x2d775a2d, 0x0f111e0f, 0xb0cb7bb0, 0x54fca854, 0xbbd66dbb, 0x163a2c16 ]
    T4 = [ 0x6363a5c6, 0x7c7c84f8, 0x777799ee, 0x7b7b8df6, 0xf2f20dff, 0x6b6bbdd6, 0x6f6fb1de, 0xc5c55491, 0x30305060, 0x01010302, 0x6767a9ce, 0x2b2b7d56, 0xfefe19e7, 0xd7d762b5, 0xababe64d, 0x76769aec, 0xcaca458f, 0x82829d1f, 0xc9c94089, 0x7d7d87fa, 0xfafa15ef, 0x5959ebb2, 0x4747c98e, 0xf0f00bfb, 0xadadec41, 0xd4d467b3, 0xa2a2fd5f, 0xafafea45, 0x9c9cbf23, 0xa4a4f753, 0x727296e4, 0xc0c05b9b, 0xb7b7c275, 0xfdfd1ce1, 0x9393ae3d, 0x26266a4c, 0x36365a6c, 0x3f3f417e, 0xf7f702f5, 0xcccc4f83, 0x34345c68, 0xa5a5f451, 0xe5e534d1, 0xf1f108f9, 0x717193e2, 0xd8d873ab, 0x31315362, 0x15153f2a, 0x04040c08, 0xc7c75295, 0x23236546, 0xc3c35e9d, 0x18182830, 0x9696a137, 0x05050f0a, 0x9a9ab52f, 0x0707090e, 0x12123624, 0x80809b1b, 0xe2e23ddf, 0xebeb26cd, 0x2727694e, 0xb2b2cd7f, 0x75759fea, 0x09091b12, 0x83839e1d, 0x2c2c7458, 0x1a1a2e34, 0x1b1b2d36, 0x6e6eb2dc, 0x5a5aeeb4, 0xa0a0fb5b, 0x5252f6a4, 0x3b3b4d76, 0xd6d661b7, 0xb3b3ce7d, 0x29297b52, 0xe3e33edd, 0x2f2f715e, 0x84849713, 0x5353f5a6, 0xd1d168b9, 0x00000000, 0xeded2cc1, 0x20206040, 0xfcfc1fe3, 0xb1b1c879, 0x5b5bedb6, 0x6a6abed4, 0xcbcb468d, 0xbebed967, 0x39394b72, 0x4a4ade94, 0x4c4cd498, 0x5858e8b0, 0xcfcf4a85, 0xd0d06bbb, 0xefef2ac5, 0xaaaae54f, 0xfbfb16ed, 0x4343c586, 0x4d4dd79a, 0x33335566, 0x85859411, 0x4545cf8a, 0xf9f910e9, 0x02020604, 0x7f7f81fe, 0x5050f0a0, 0x3c3c4478, 0x9f9fba25, 0xa8a8e34b, 0x5151f3a2, 0xa3a3fe5d, 0x4040c080, 0x8f8f8a05, 0x9292ad3f, 0x9d9dbc21, 0x38384870, 0xf5f504f1, 0xbcbcdf63, 0xb6b6c177, 0xdada75af, 0x21216342, 0x10103020, 0xffff1ae5, 0xf3f30efd, 0xd2d26dbf, 0xcdcd4c81, 0x0c0c1418, 0x13133526, 0xecec2fc3, 0x5f5fe1be, 0x9797a235, 0x4444cc88, 0x1717392e, 0xc4c45793, 0xa7a7f255, 0x7e7e82fc, 0x3d3d477a, 0x6464acc8, 0x5d5de7ba, 0x19192b32, 0x737395e6, 0x6060a0c0, 0x81819819, 0x4f4fd19e, 0xdcdc7fa3, 0x22226644, 0x2a2a7e54, 0x9090ab3b, 0x8888830b, 0x4646ca8c, 0xeeee29c7, 0xb8b8d36b, 0x14143c28, 0xdede79a7, 0x5e5ee2bc, 0x0b0b1d16, 0xdbdb76ad, 0xe0e03bdb, 0x32325664, 0x3a3a4e74, 0x0a0a1e14, 0x4949db92, 0x06060a0c, 0x24246c48, 0x5c5ce4b8, 0xc2c25d9f, 0xd3d36ebd, 0xacacef43, 0x6262a6c4, 0x9191a839, 0x9595a431, 0xe4e437d3, 0x79798bf2, 0xe7e732d5, 0xc8c8438b, 0x3737596e, 0x6d6db7da, 0x8d8d8c01, 0xd5d564b1, 0x4e4ed29c, 0xa9a9e049, 0x6c6cb4d8, 0x5656faac, 0xf4f407f3, 0xeaea25cf, 0x6565afca, 0x7a7a8ef4, 0xaeaee947, 0x08081810, 0xbabad56f, 0x787888f0, 0x25256f4a, 0x2e2e725c, 0x1c1c2438, 0xa6a6f157, 0xb4b4c773, 0xc6c65197, 0xe8e823cb, 0xdddd7ca1, 0x74749ce8, 0x1f1f213e, 0x4b4bdd96, 0xbdbddc61, 0x8b8b860d, 0x8a8a850f, 0x707090e0, 0x3e3e427c, 0xb5b5c471, 0x6666aacc, 0x4848d890, 0x03030506, 0xf6f601f7, 0x0e0e121c, 0x6161a3c2, 0x35355f6a, 0x5757f9ae, 0xb9b9d069, 0x86869117, 0xc1c15899, 0x1d1d273a, 0x9e9eb927, 0xe1e138d9, 0xf8f813eb, 0x9898b32b, 0x11113322, 0x6969bbd2, 0xd9d970a9, 0x8e8e8907, 0x9494a733, 0x9b9bb62d, 0x1e1e223c, 0x87879215, 0xe9e920c9, 0xcece4987, 0x5555ffaa, 0x28287850, 0xdfdf7aa5, 0x8c8c8f03, 0xa1a1f859, 0x89898009, 0x0d0d171a, 0xbfbfda65, 0xe6e631d7, 0x4242c684, 0x6868b8d0, 0x4141c382, 0x9999b029, 0x2d2d775a, 0x0f0f111e, 0xb0b0cb7b, 0x5454fca8, 0xbbbbd66d, 0x16163a2c ]

    # Transformations for decryption
    T5 = [ 0x51f4a750, 0x7e416553, 0x1a17a4c3, 0x3a275e96, 0x3bab6bcb, 0x1f9d45f1, 0xacfa58ab, 0x4be30393, 0x2030fa55, 0xad766df6, 0x88cc7691, 0xf5024c25, 0x4fe5d7fc, 0xc52acbd7, 0x26354480, 0xb562a38f, 0xdeb15a49, 0x25ba1b67, 0x45ea0e98, 0x5dfec0e1, 0xc32f7502, 0x814cf012, 0x8d4697a3, 0x6bd3f9c6, 0x038f5fe7, 0x15929c95, 0xbf6d7aeb, 0x955259da, 0xd4be832d, 0x587421d3, 0x49e06929, 0x8ec9c844, 0x75c2896a, 0xf48e7978, 0x99583e6b, 0x27b971dd, 0xbee14fb6, 0xf088ad17, 0xc920ac66, 0x7dce3ab4, 0x63df4a18, 0xe51a3182, 0x97513360, 0x62537f45, 0xb16477e0, 0xbb6bae84, 0xfe81a01c, 0xf9082b94, 0x70486858, 0x8f45fd19, 0x94de6c87, 0x527bf8b7, 0xab73d323, 0x724b02e2, 0xe31f8f57, 0x6655ab2a, 0xb2eb2807, 0x2fb5c203, 0x86c57b9a, 0xd33708a5, 0x302887f2, 0x23bfa5b2, 0x02036aba, 0xed16825c, 0x8acf1c2b, 0xa779b492, 0xf307f2f0, 0x4e69e2a1, 0x65daf4cd, 0x0605bed5, 0xd134621f, 0xc4a6fe8a, 0x342e539d, 0xa2f355a0, 0x058ae132, 0xa4f6eb75, 0x0b83ec39, 0x4060efaa, 0x5e719f06, 0xbd6e1051, 0x3e218af9, 0x96dd063d, 0xdd3e05ae, 0x4de6bd46, 0x91548db5, 0x71c45d05, 0x0406d46f, 0x605015ff, 0x1998fb24, 0xd6bde997, 0x894043cc, 0x67d99e77, 0xb0e842bd, 0x07898b88, 0xe7195b38, 0x79c8eedb, 0xa17c0a47, 0x7c420fe9, 0xf8841ec9, 0x00000000, 0x09808683, 0x322bed48, 0x1e1170ac, 0x6c5a724e, 0xfd0efffb, 0x0f853856, 0x3daed51e, 0x362d3927, 0x0a0fd964, 0x685ca621, 0x9b5b54d1, 0x24362e3a, 0x0c0a67b1, 0x9357e70f, 0xb4ee96d2, 0x1b9b919e, 0x80c0c54f, 0x61dc20a2, 0x5a774b69, 0x1c121a16, 0xe293ba0a, 0xc0a02ae5, 0x3c22e043, 0x121b171d, 0x0e090d0b, 0xf28bc7ad, 0x2db6a8b9, 0x141ea9c8, 0x57f11985, 0xaf75074c, 0xee99ddbb, 0xa37f60fd, 0xf701269f, 0x5c72f5bc, 0x44663bc5, 0x5bfb7e34, 0x8b432976, 0xcb23c6dc, 0xb6edfc68, 0xb8e4f163, 0xd731dcca, 0x42638510, 0x13972240, 0x84c61120, 0x854a247d, 0xd2bb3df8, 0xaef93211, 0xc729a16d, 0x1d9e2f4b, 0xdcb230f3, 0x0d8652ec, 0x77c1e3d0, 0x2bb3166c, 0xa970b999, 0x119448fa, 0x47e96422, 0xa8fc8cc4, 0xa0f03f1a, 0x567d2cd8, 0x223390ef, 0x87494ec7, 0xd938d1c1, 0x8ccaa2fe, 0x98d40b36, 0xa6f581cf, 0xa57ade28, 0xdab78e26, 0x3fadbfa4, 0x2c3a9de4, 0x5078920d, 0x6a5fcc9b, 0x547e4662, 0xf68d13c2, 0x90d8b8e8, 0x2e39f75e, 0x82c3aff5, 0x9f5d80be, 0x69d0937c, 0x6fd52da9, 0xcf2512b3, 0xc8ac993b, 0x10187da7, 0xe89c636e, 0xdb3bbb7b, 0xcd267809, 0x6e5918f4, 0xec9ab701, 0x834f9aa8, 0xe6956e65, 0xaaffe67e, 0x21bccf08, 0xef15e8e6, 0xbae79bd9, 0x4a6f36ce, 0xea9f09d4, 0x29b07cd6, 0x31a4b2af, 0x2a3f2331, 0xc6a59430, 0x35a266c0, 0x744ebc37, 0xfc82caa6, 0xe090d0b0, 0x33a7d815, 0xf104984a, 0x41ecdaf7, 0x7fcd500e, 0x1791f62f, 0x764dd68d, 0x43efb04d, 0xccaa4d54, 0xe49604df, 0x9ed1b5e3, 0x4c6a881b, 0xc12c1fb8, 0x4665517f, 0x9d5eea04, 0x018c355d, 0xfa877473, 0xfb0b412e, 0xb3671d5a, 0x92dbd252, 0xe9105633, 0x6dd64713, 0x9ad7618c, 0x37a10c7a, 0x59f8148e, 0xeb133c89, 0xcea927ee, 0xb761c935, 0xe11ce5ed, 0x7a47b13c, 0x9cd2df59, 0x55f2733f, 0x1814ce79, 0x73c737bf, 0x53f7cdea, 0x5ffdaa5b, 0xdf3d6f14, 0x7844db86, 0xcaaff381, 0xb968c43e, 0x3824342c, 0xc2a3405f, 0x161dc372, 0xbce2250c, 0x283c498b, 0xff0d9541, 0x39a80171, 0x080cb3de, 0xd8b4e49c, 0x6456c190, 0x7bcb8461, 0xd532b670, 0x486c5c74, 0xd0b85742 ]
    T6 = [ 0x5051f4a7, 0x537e4165, 0xc31a17a4, 0x963a275e, 0xcb3bab6b, 0xf11f9d45, 0xabacfa58, 0x934be303, 0x552030fa, 0xf6ad766d, 0x9188cc76, 0x25f5024c, 0xfc4fe5d7, 0xd7c52acb, 0x80263544, 0x8fb562a3, 0x49deb15a, 0x6725ba1b, 0x9845ea0e, 0xe15dfec0, 0x02c32f75, 0x12814cf0, 0xa38d4697, 0xc66bd3f9, 0xe7038f5f, 0x9515929c, 0xebbf6d7a, 0xda955259, 0x2dd4be83, 0xd3587421, 0x2949e069, 0x448ec9c8, 0x6a75c289, 0x78f48e79, 0x6b99583e, 0xdd27b971, 0xb6bee14f, 0x17f088ad, 0x66c920ac, 0xb47dce3a, 0x1863df4a, 0x82e51a31, 0x60975133, 0x4562537f, 0xe0b16477, 0x84bb6bae, 0x1cfe81a0, 0x94f9082b, 0x58704868, 0x198f45fd, 0x8794de6c, 0xb7527bf8, 0x23ab73d3, 0xe2724b02, 0x57e31f8f, 0x2a6655ab, 0x07b2eb28, 0x032fb5c2, 0x9a86c57b, 0xa5d33708, 0xf2302887, 0xb223bfa5, 0xba02036a, 0x5ced1682, 0x2b8acf1c, 0x92a779b4, 0xf0f307f2, 0xa14e69e2, 0xcd65daf4, 0xd50605be, 0x1fd13462, 0x8ac4a6fe, 0x9d342e53, 0xa0a2f355, 0x32058ae1, 0x75a4f6eb, 0x390b83ec, 0xaa4060ef, 0x065e719f, 0x51bd6e10, 0xf93e218a, 0x3d96dd06, 0xaedd3e05, 0x464de6bd, 0xb591548d, 0x0571c45d, 0x6f0406d4, 0xff605015, 0x241998fb, 0x97d6bde9, 0xcc894043, 0x7767d99e, 0xbdb0e842, 0x8807898b, 0x38e7195b, 0xdb79c8ee, 0x47a17c0a, 0xe97c420f, 0xc9f8841e, 0x00000000, 0x83098086, 0x48322bed, 0xac1e1170, 0x4e6c5a72, 0xfbfd0eff, 0x560f8538, 0x1e3daed5, 0x27362d39, 0x640a0fd9, 0x21685ca6, 0xd19b5b54, 0x3a24362e, 0xb10c0a67, 0x0f9357e7, 0xd2b4ee96, 0x9e1b9b91, 0x4f80c0c5, 0xa261dc20, 0x695a774b, 0x161c121a, 0x0ae293ba, 0xe5c0a02a, 0x433c22e0, 0x1d121b17, 0x0b0e090d, 0xadf28bc7, 0xb92db6a8, 0xc8141ea9, 0x8557f119, 0x4caf7507, 0xbbee99dd, 0xfda37f60, 0x9ff70126, 0xbc5c72f5, 0xc544663b, 0x345bfb7e, 0x768b4329, 0xdccb23c6, 0x68b6edfc, 0x63b8e4f1, 0xcad731dc, 0x10426385, 0x40139722, 0x2084c611, 0x7d854a24, 0xf8d2bb3d, 0x11aef932, 0x6dc729a1, 0x4b1d9e2f, 0xf3dcb230, 0xec0d8652, 0xd077c1e3, 0x6c2bb316, 0x99a970b9, 0xfa119448, 0x2247e964, 0xc4a8fc8c, 0x1aa0f03f, 0xd8567d2c, 0xef223390, 0xc787494e, 0xc1d938d1, 0xfe8ccaa2, 0x3698d40b, 0xcfa6f581, 0x28a57ade, 0x26dab78e, 0xa43fadbf, 0xe42c3a9d, 0x0d507892, 0x9b6a5fcc, 0x62547e46, 0xc2f68d13, 0xe890d8b8, 0x5e2e39f7, 0xf582c3af, 0xbe9f5d80, 0x7c69d093, 0xa96fd52d, 0xb3cf2512, 0x3bc8ac99, 0xa710187d, 0x6ee89c63, 0x7bdb3bbb, 0x09cd2678, 0xf46e5918, 0x01ec9ab7, 0xa8834f9a, 0x65e6956e, 0x7eaaffe6, 0x0821bccf, 0xe6ef15e8, 0xd9bae79b, 0xce4a6f36, 0xd4ea9f09, 0xd629b07c, 0xaf31a4b2, 0x312a3f23, 0x30c6a594, 0xc035a266, 0x37744ebc, 0xa6fc82ca, 0xb0e090d0, 0x1533a7d8, 0x4af10498, 0xf741ecda, 0x0e7fcd50, 0x2f1791f6, 0x8d764dd6, 0x4d43efb0, 0x54ccaa4d, 0xdfe49604, 0xe39ed1b5, 0x1b4c6a88, 0xb8c12c1f, 0x7f466551, 0x049d5eea, 0x5d018c35, 0x73fa8774, 0x2efb0b41, 0x5ab3671d, 0x5292dbd2, 0x33e91056, 0x136dd647, 0x8c9ad761, 0x7a37a10c, 0x8e59f814, 0x89eb133c, 0xeecea927, 0x35b761c9, 0xede11ce5, 0x3c7a47b1, 0x599cd2df, 0x3f55f273, 0x791814ce, 0xbf73c737, 0xea53f7cd, 0x5b5ffdaa, 0x14df3d6f, 0x867844db, 0x81caaff3, 0x3eb968c4, 0x2c382434, 0x5fc2a340, 0x72161dc3, 0x0cbce225, 0x8b283c49, 0x41ff0d95, 0x7139a801, 0xde080cb3, 0x9cd8b4e4, 0x906456c1, 0x617bcb84, 0x70d532b6, 0x74486c5c, 0x42d0b857 ]
    T7 = [ 0xa75051f4, 0x65537e41, 0xa4c31a17, 0x5e963a27, 0x6bcb3bab, 0x45f11f9d, 0x58abacfa, 0x03934be3, 0xfa552030, 0x6df6ad76, 0x769188cc, 0x4c25f502, 0xd7fc4fe5, 0xcbd7c52a, 0x44802635, 0xa38fb562, 0x5a49deb1, 0x1b6725ba, 0x0e9845ea, 0xc0e15dfe, 0x7502c32f, 0xf012814c, 0x97a38d46, 0xf9c66bd3, 0x5fe7038f, 0x9c951592, 0x7aebbf6d, 0x59da9552, 0x832dd4be, 0x21d35874, 0x692949e0, 0xc8448ec9, 0x896a75c2, 0x7978f48e, 0x3e6b9958, 0x71dd27b9, 0x4fb6bee1, 0xad17f088, 0xac66c920, 0x3ab47dce, 0x4a1863df, 0x3182e51a, 0x33609751, 0x7f456253, 0x77e0b164, 0xae84bb6b, 0xa01cfe81, 0x2b94f908, 0x68587048, 0xfd198f45, 0x6c8794de, 0xf8b7527b, 0xd323ab73, 0x02e2724b, 0x8f57e31f, 0xab2a6655, 0x2807b2eb, 0xc2032fb5, 0x7b9a86c5, 0x08a5d337, 0x87f23028, 0xa5b223bf, 0x6aba0203, 0x825ced16, 0x1c2b8acf, 0xb492a779, 0xf2f0f307, 0xe2a14e69, 0xf4cd65da, 0xbed50605, 0x621fd134, 0xfe8ac4a6, 0x539d342e, 0x55a0a2f3, 0xe132058a, 0xeb75a4f6, 0xec390b83, 0xefaa4060, 0x9f065e71, 0x1051bd6e, 0x8af93e21, 0x063d96dd, 0x05aedd3e, 0xbd464de6, 0x8db59154, 0x5d0571c4, 0xd46f0406, 0x15ff6050, 0xfb241998, 0xe997d6bd, 0x43cc8940, 0x9e7767d9, 0x42bdb0e8, 0x8b880789, 0x5b38e719, 0xeedb79c8, 0x0a47a17c, 0x0fe97c42, 0x1ec9f884, 0x00000000, 0x86830980, 0xed48322b, 0x70ac1e11, 0x724e6c5a, 0xfffbfd0e, 0x38560f85, 0xd51e3dae, 0x3927362d, 0xd9640a0f, 0xa621685c, 0x54d19b5b, 0x2e3a2436, 0x67b10c0a, 0xe70f9357, 0x96d2b4ee, 0x919e1b9b, 0xc54f80c0, 0x20a261dc, 0x4b695a77, 0x1a161c12, 0xba0ae293, 0x2ae5c0a0, 0xe0433c22, 0x171d121b, 0x0d0b0e09, 0xc7adf28b, 0xa8b92db6, 0xa9c8141e, 0x198557f1, 0x074caf75, 0xddbbee99, 0x60fda37f, 0x269ff701, 0xf5bc5c72, 0x3bc54466, 0x7e345bfb, 0x29768b43, 0xc6dccb23, 0xfc68b6ed, 0xf163b8e4, 0xdccad731, 0x85104263, 0x22401397, 0x112084c6, 0x247d854a, 0x3df8d2bb, 0x3211aef9, 0xa16dc729, 0x2f4b1d9e, 0x30f3dcb2, 0x52ec0d86, 0xe3d077c1, 0x166c2bb3, 0xb999a970, 0x48fa1194, 0x642247e9, 0x8cc4a8fc, 0x3f1aa0f0, 0x2cd8567d, 0x90ef2233, 0x4ec78749, 0xd1c1d938, 0xa2fe8cca, 0x0b3698d4, 0x81cfa6f5, 0xde28a57a, 0x8e26dab7, 0xbfa43fad, 0x9de42c3a, 0x920d5078, 0xcc9b6a5f, 0x4662547e, 0x13c2f68d, 0xb8e890d8, 0xf75e2e39, 0xaff582c3, 0x80be9f5d, 0x937c69d0, 0x2da96fd5, 0x12b3cf25, 0x993bc8ac, 0x7da71018, 0x636ee89c, 0xbb7bdb3b, 0x7809cd26, 0x18f46e59, 0xb701ec9a, 0x9aa8834f, 0x6e65e695, 0xe67eaaff, 0xcf0821bc, 0xe8e6ef15, 0x9bd9bae7, 0x36ce4a6f, 0x09d4ea9f, 0x7cd629b0, 0xb2af31a4, 0x23312a3f, 0x9430c6a5, 0x66c035a2, 0xbc37744e, 0xcaa6fc82, 0xd0b0e090, 0xd81533a7, 0x984af104, 0xdaf741ec, 0x500e7fcd, 0xf62f1791, 0xd68d764d, 0xb04d43ef, 0x4d54ccaa, 0x04dfe496, 0xb5e39ed1, 0x881b4c6a, 0x1fb8c12c, 0x517f4665, 0xea049d5e, 0x355d018c, 0x7473fa87, 0x412efb0b, 0x1d5ab367, 0xd25292db, 0x5633e910, 0x47136dd6, 0x618c9ad7, 0x0c7a37a1, 0x148e59f8, 0x3c89eb13, 0x27eecea9, 0xc935b761, 0xe5ede11c, 0xb13c7a47, 0xdf599cd2, 0x733f55f2, 0xce791814, 0x37bf73c7, 0xcdea53f7, 0xaa5b5ffd, 0x6f14df3d, 0xdb867844, 0xf381caaf, 0xc43eb968, 0x342c3824, 0x405fc2a3, 0xc372161d, 0x250cbce2, 0x498b283c, 0x9541ff0d, 0x017139a8, 0xb3de080c, 0xe49cd8b4, 0xc1906456, 0x84617bcb, 0xb670d532, 0x5c74486c, 0x5742d0b8 ]
    T8 = [ 0xf4a75051, 0x4165537e, 0x17a4c31a, 0x275e963a, 0xab6bcb3b, 0x9d45f11f, 0xfa58abac, 0xe303934b, 0x30fa5520, 0x766df6ad, 0xcc769188, 0x024c25f5, 0xe5d7fc4f, 0x2acbd7c5, 0x35448026, 0x62a38fb5, 0xb15a49de, 0xba1b6725, 0xea0e9845, 0xfec0e15d, 0x2f7502c3, 0x4cf01281, 0x4697a38d, 0xd3f9c66b, 0x8f5fe703, 0x929c9515, 0x6d7aebbf, 0x5259da95, 0xbe832dd4, 0x7421d358, 0xe0692949, 0xc9c8448e, 0xc2896a75, 0x8e7978f4, 0x583e6b99, 0xb971dd27, 0xe14fb6be, 0x88ad17f0, 0x20ac66c9, 0xce3ab47d, 0xdf4a1863, 0x1a3182e5, 0x51336097, 0x537f4562, 0x6477e0b1, 0x6bae84bb, 0x81a01cfe, 0x082b94f9, 0x48685870, 0x45fd198f, 0xde6c8794, 0x7bf8b752, 0x73d323ab, 0x4b02e272, 0x1f8f57e3, 0x55ab2a66, 0xeb2807b2, 0xb5c2032f, 0xc57b9a86, 0x3708a5d3, 0x2887f230, 0xbfa5b223, 0x036aba02, 0x16825ced, 0xcf1c2b8a, 0x79b492a7, 0x07f2f0f3, 0x69e2a14e, 0xdaf4cd65, 0x05bed506, 0x34621fd1, 0xa6fe8ac4, 0x2e539d34, 0xf355a0a2, 0x8ae13205, 0xf6eb75a4, 0x83ec390b, 0x60efaa40, 0x719f065e, 0x6e1051bd, 0x218af93e, 0xdd063d96, 0x3e05aedd, 0xe6bd464d, 0x548db591, 0xc45d0571, 0x06d46f04, 0x5015ff60, 0x98fb2419, 0xbde997d6, 0x4043cc89, 0xd99e7767, 0xe842bdb0, 0x898b8807, 0x195b38e7, 0xc8eedb79, 0x7c0a47a1, 0x420fe97c, 0x841ec9f8, 0x00000000, 0x80868309, 0x2bed4832, 0x1170ac1e, 0x5a724e6c, 0x0efffbfd, 0x8538560f, 0xaed51e3d, 0x2d392736, 0x0fd9640a, 0x5ca62168, 0x5b54d19b, 0x362e3a24, 0x0a67b10c, 0x57e70f93, 0xee96d2b4, 0x9b919e1b, 0xc0c54f80, 0xdc20a261, 0x774b695a, 0x121a161c, 0x93ba0ae2, 0xa02ae5c0, 0x22e0433c, 0x1b171d12, 0x090d0b0e, 0x8bc7adf2, 0xb6a8b92d, 0x1ea9c814, 0xf1198557, 0x75074caf, 0x99ddbbee, 0x7f60fda3, 0x01269ff7, 0x72f5bc5c, 0x663bc544, 0xfb7e345b, 0x4329768b, 0x23c6dccb, 0xedfc68b6, 0xe4f163b8, 0x31dccad7, 0x63851042, 0x97224013, 0xc6112084, 0x4a247d85, 0xbb3df8d2, 0xf93211ae, 0x29a16dc7, 0x9e2f4b1d, 0xb230f3dc, 0x8652ec0d, 0xc1e3d077, 0xb3166c2b, 0x70b999a9, 0x9448fa11, 0xe9642247, 0xfc8cc4a8, 0xf03f1aa0, 0x7d2cd856, 0x3390ef22, 0x494ec787, 0x38d1c1d9, 0xcaa2fe8c, 0xd40b3698, 0xf581cfa6, 0x7ade28a5, 0xb78e26da, 0xadbfa43f, 0x3a9de42c, 0x78920d50, 0x5fcc9b6a, 0x7e466254, 0x8d13c2f6, 0xd8b8e890, 0x39f75e2e, 0xc3aff582, 0x5d80be9f, 0xd0937c69, 0xd52da96f, 0x2512b3cf, 0xac993bc8, 0x187da710, 0x9c636ee8, 0x3bbb7bdb, 0x267809cd, 0x5918f46e, 0x9ab701ec, 0x4f9aa883, 0x956e65e6, 0xffe67eaa, 0xbccf0821, 0x15e8e6ef, 0xe79bd9ba, 0x6f36ce4a, 0x9f09d4ea, 0xb07cd629, 0xa4b2af31, 0x3f23312a, 0xa59430c6, 0xa266c035, 0x4ebc3774, 0x82caa6fc, 0x90d0b0e0, 0xa7d81533, 0x04984af1, 0xecdaf741, 0xcd500e7f, 0x91f62f17, 0x4dd68d76, 0xefb04d43, 0xaa4d54cc, 0x9604dfe4, 0xd1b5e39e, 0x6a881b4c, 0x2c1fb8c1, 0x65517f46, 0x5eea049d, 0x8c355d01, 0x877473fa, 0x0b412efb, 0x671d5ab3, 0xdbd25292, 0x105633e9, 0xd647136d, 0xd7618c9a, 0xa10c7a37, 0xf8148e59, 0x133c89eb, 0xa927eece, 0x61c935b7, 0x1ce5ede1, 0x47b13c7a, 0xd2df599c, 0xf2733f55, 0x14ce7918, 0xc737bf73, 0xf7cdea53, 0xfdaa5b5f, 0x3d6f14df, 0x44db8678, 0xaff381ca, 0x68c43eb9, 0x24342c38, 0xa3405fc2, 0x1dc37216, 0xe2250cbc, 0x3c498b28, 0x0d9541ff, 0xa8017139, 0x0cb3de08, 0xb4e49cd8, 0x56c19064, 0xcb84617b, 0x32b670d5, 0x6c5c7448, 0xb85742d0 ]

    # Transformations for decryption key expansion
    U1 = [ 0x00000000, 0x0e090d0b, 0x1c121a16, 0x121b171d, 0x3824342c, 0x362d3927, 0x24362e3a, 0x2a3f2331, 0x70486858, 0x7e416553, 0x6c5a724e, 0x62537f45, 0x486c5c74, 0x4665517f, 0x547e4662, 0x5a774b69, 0xe090d0b0, 0xee99ddbb, 0xfc82caa6, 0xf28bc7ad, 0xd8b4e49c, 0xd6bde997, 0xc4a6fe8a, 0xcaaff381, 0x90d8b8e8, 0x9ed1b5e3, 0x8ccaa2fe, 0x82c3aff5, 0xa8fc8cc4, 0xa6f581cf, 0xb4ee96d2, 0xbae79bd9, 0xdb3bbb7b, 0xd532b670, 0xc729a16d, 0xc920ac66, 0xe31f8f57, 0xed16825c, 0xff0d9541, 0xf104984a, 0xab73d323, 0xa57ade28, 0xb761c935, 0xb968c43e, 0x9357e70f, 0x9d5eea04, 0x8f45fd19, 0x814cf012, 0x3bab6bcb, 0x35a266c0, 0x27b971dd, 0x29b07cd6, 0x038f5fe7, 0x0d8652ec, 0x1f9d45f1, 0x119448fa, 0x4be30393, 0x45ea0e98, 0x57f11985, 0x59f8148e, 0x73c737bf, 0x7dce3ab4, 0x6fd52da9, 0x61dc20a2, 0xad766df6, 0xa37f60fd, 0xb16477e0, 0xbf6d7aeb, 0x955259da, 0x9b5b54d1, 0x894043cc, 0x87494ec7, 0xdd3e05ae, 0xd33708a5, 0xc12c1fb8, 0xcf2512b3, 0xe51a3182, 0xeb133c89, 0xf9082b94, 0xf701269f, 0x4de6bd46, 0x43efb04d, 0x51f4a750, 0x5ffdaa5b, 0x75c2896a, 0x7bcb8461, 0x69d0937c, 0x67d99e77, 0x3daed51e, 0x33a7d815, 0x21bccf08, 0x2fb5c203, 0x058ae132, 0x0b83ec39, 0x1998fb24, 0x1791f62f, 0x764dd68d, 0x7844db86, 0x6a5fcc9b, 0x6456c190, 0x4e69e2a1, 0x4060efaa, 0x527bf8b7, 0x5c72f5bc, 0x0605bed5, 0x080cb3de, 0x1a17a4c3, 0x141ea9c8, 0x3e218af9, 0x302887f2, 0x223390ef, 0x2c3a9de4, 0x96dd063d, 0x98d40b36, 0x8acf1c2b, 0x84c61120, 0xaef93211, 0xa0f03f1a, 0xb2eb2807, 0xbce2250c, 0xe6956e65, 0xe89c636e, 0xfa877473, 0xf48e7978, 0xdeb15a49, 0xd0b85742, 0xc2a3405f, 0xccaa4d54, 0x41ecdaf7, 0x4fe5d7fc, 0x5dfec0e1, 0x53f7cdea, 0x79c8eedb, 0x77c1e3d0, 0x65daf4cd, 0x6bd3f9c6, 0x31a4b2af, 0x3fadbfa4, 0x2db6a8b9, 0x23bfa5b2, 0x09808683, 0x07898b88, 0x15929c95, 0x1b9b919e, 0xa17c0a47, 0xaf75074c, 0xbd6e1051, 0xb3671d5a, 0x99583e6b, 0x97513360, 0x854a247d, 0x8b432976, 0xd134621f, 0xdf3d6f14, 0xcd267809, 0xc32f7502, 0xe9105633, 0xe7195b38, 0xf5024c25, 0xfb0b412e, 0x9ad7618c, 0x94de6c87, 0x86c57b9a, 0x88cc7691, 0xa2f355a0, 0xacfa58ab, 0xbee14fb6, 0xb0e842bd, 0xea9f09d4, 0xe49604df, 0xf68d13c2, 0xf8841ec9, 0xd2bb3df8, 0xdcb230f3, 0xcea927ee, 0xc0a02ae5, 0x7a47b13c, 0x744ebc37, 0x6655ab2a, 0x685ca621, 0x42638510, 0x4c6a881b, 0x5e719f06, 0x5078920d, 0x0a0fd964, 0x0406d46f, 0x161dc372, 0x1814ce79, 0x322bed48, 0x3c22e043, 0x2e39f75e, 0x2030fa55, 0xec9ab701, 0xe293ba0a, 0xf088ad17, 0xfe81a01c, 0xd4be832d, 0xdab78e26, 0xc8ac993b, 0xc6a59430, 0x9cd2df59, 0x92dbd252, 0x80c0c54f, 0x8ec9c844, 0xa4f6eb75, 0xaaffe67e, 0xb8e4f163, 0xb6edfc68, 0x0c0a67b1, 0x02036aba, 0x10187da7, 0x1e1170ac, 0x342e539d, 0x3a275e96, 0x283c498b, 0x26354480, 0x7c420fe9, 0x724b02e2, 0x605015ff, 0x6e5918f4, 0x44663bc5, 0x4a6f36ce, 0x587421d3, 0x567d2cd8, 0x37a10c7a, 0x39a80171, 0x2bb3166c, 0x25ba1b67, 0x0f853856, 0x018c355d, 0x13972240, 0x1d9e2f4b, 0x47e96422, 0x49e06929, 0x5bfb7e34, 0x55f2733f, 0x7fcd500e, 0x71c45d05, 0x63df4a18, 0x6dd64713, 0xd731dcca, 0xd938d1c1, 0xcb23c6dc, 0xc52acbd7, 0xef15e8e6, 0xe11ce5ed, 0xf307f2f0, 0xfd0efffb, 0xa779b492, 0xa970b999, 0xbb6bae84, 0xb562a38f, 0x9f5d80be, 0x91548db5, 0x834f9aa8, 0x8d4697a3 ]
    U2 = [ 0x00000000, 0x0b0e090d, 0x161c121a, 0x1d121b17, 0x2c382434, 0x27362d39, 0x3a24362e, 0x312a3f23, 0x58704868, 0x537e4165, 0x4e6c5a72, 0x4562537f, 0x74486c5c, 0x7f466551, 0x62547e46, 0x695a774b, 0xb0e090d0, 0xbbee99dd, 0xa6fc82ca, 0xadf28bc7, 0x9cd8b4e4, 0x97d6bde9, 0x8ac4a6fe, 0x81caaff3, 0xe890d8b8, 0xe39ed1b5, 0xfe8ccaa2, 0xf582c3af, 0xc4a8fc8c, 0xcfa6f581, 0xd2b4ee96, 0xd9bae79b, 0x7bdb3bbb, 0x70d532b6, 0x6dc729a1, 0x66c920ac, 0x57e31f8f, 0x5ced1682, 0x41ff0d95, 0x4af10498, 0x23ab73d3, 0x28a57ade, 0x35b761c9, 0x3eb968c4, 0x0f9357e7, 0x049d5eea, 0x198f45fd, 0x12814cf0, 0xcb3bab6b, 0xc035a266, 0xdd27b971, 0xd629b07c, 0xe7038f5f, 0xec0d8652, 0xf11f9d45, 0xfa119448, 0x934be303, 0x9845ea0e, 0x8557f119, 0x8e59f814, 0xbf73c737, 0xb47dce3a, 0xa96fd52d, 0xa261dc20, 0xf6ad766d, 0xfda37f60, 0xe0b16477, 0xebbf6d7a, 0xda955259, 0xd19b5b54, 0xcc894043, 0xc787494e, 0xaedd3e05, 0xa5d33708, 0xb8c12c1f, 0xb3cf2512, 0x82e51a31, 0x89eb133c, 0x94f9082b, 0x9ff70126, 0x464de6bd, 0x4d43efb0, 0x5051f4a7, 0x5b5ffdaa, 0x6a75c289, 0x617bcb84, 0x7c69d093, 0x7767d99e, 0x1e3daed5, 0x1533a7d8, 0x0821bccf, 0x032fb5c2, 0x32058ae1, 0x390b83ec, 0x241998fb, 0x2f1791f6, 0x8d764dd6, 0x867844db, 0x9b6a5fcc, 0x906456c1, 0xa14e69e2, 0xaa4060ef, 0xb7527bf8, 0xbc5c72f5, 0xd50605be, 0xde080cb3, 0xc31a17a4, 0xc8141ea9, 0xf93e218a, 0xf2302887, 0xef223390, 0xe42c3a9d, 0x3d96dd06, 0x3698d40b, 0x2b8acf1c, 0x2084c611, 0x11aef932, 0x1aa0f03f, 0x07b2eb28, 0x0cbce225, 0x65e6956e, 0x6ee89c63, 0x73fa8774, 0x78f48e79, 0x49deb15a, 0x42d0b857, 0x5fc2a340, 0x54ccaa4d, 0xf741ecda, 0xfc4fe5d7, 0xe15dfec0, 0xea53f7cd, 0xdb79c8ee, 0xd077c1e3, 0xcd65daf4, 0xc66bd3f9, 0xaf31a4b2, 0xa43fadbf, 0xb92db6a8, 0xb223bfa5, 0x83098086, 0x8807898b, 0x9515929c, 0x9e1b9b91, 0x47a17c0a, 0x4caf7507, 0x51bd6e10, 0x5ab3671d, 0x6b99583e, 0x60975133, 0x7d854a24, 0x768b4329, 0x1fd13462, 0x14df3d6f, 0x09cd2678, 0x02c32f75, 0x33e91056, 0x38e7195b, 0x25f5024c, 0x2efb0b41, 0x8c9ad761, 0x8794de6c, 0x9a86c57b, 0x9188cc76, 0xa0a2f355, 0xabacfa58, 0xb6bee14f, 0xbdb0e842, 0xd4ea9f09, 0xdfe49604, 0xc2f68d13, 0xc9f8841e, 0xf8d2bb3d, 0xf3dcb230, 0xeecea927, 0xe5c0a02a, 0x3c7a47b1, 0x37744ebc, 0x2a6655ab, 0x21685ca6, 0x10426385, 0x1b4c6a88, 0x065e719f, 0x0d507892, 0x640a0fd9, 0x6f0406d4, 0x72161dc3, 0x791814ce, 0x48322bed, 0x433c22e0, 0x5e2e39f7, 0x552030fa, 0x01ec9ab7, 0x0ae293ba, 0x17f088ad, 0x1cfe81a0, 0x2dd4be83, 0x26dab78e, 0x3bc8ac99, 0x30c6a594, 0x599cd2df, 0x5292dbd2, 0x4f80c0c5, 0x448ec9c8, 0x75a4f6eb, 0x7eaaffe6, 0x63b8e4f1, 0x68b6edfc, 0xb10c0a67, 0xba02036a, 0xa710187d, 0xac1e1170, 0x9d342e53, 0x963a275e, 0x8b283c49, 0x80263544, 0xe97c420f, 0xe2724b02, 0xff605015, 0xf46e5918, 0xc544663b, 0xce4a6f36, 0xd3587421, 0xd8567d2c, 0x7a37a10c, 0x7139a801, 0x6c2bb316, 0x6725ba1b, 0x560f8538, 0x5d018c35, 0x40139722, 0x4b1d9e2f, 0x2247e964, 0x2949e069, 0x345bfb7e, 0x3f55f273, 0x0e7fcd50, 0x0571c45d, 0x1863df4a, 0x136dd647, 0xcad731dc, 0xc1d938d1, 0xdccb23c6, 0xd7c52acb, 0xe6ef15e8, 0xede11ce5, 0xf0f307f2, 0xfbfd0eff, 0x92a779b4, 0x99a970b9, 0x84bb6bae, 0x8fb562a3, 0xbe9f5d80, 0xb591548d, 0xa8834f9a, 0xa38d4697 ]
    U3 = [ 0x00000000, 0x0d0b0e09, 0x1a161c12, 0x171d121b, 0x342c3824, 0x3927362d, 0x2e3a2436, 0x23312a3f, 0x68587048, 0x65537e41, 0x724e6c5a, 0x7f456253, 0x5c74486c, 0x517f4665, 0x4662547e, 0x4b695a77, 0xd0b0e090, 0xddbbee99, 0xcaa6fc82, 0xc7adf28b, 0xe49cd8b4, 0xe997d6bd, 0xfe8ac4a6, 0xf381caaf, 0xb8e890d8, 0xb5e39ed1, 0xa2fe8cca, 0xaff582c3, 0x8cc4a8fc, 0x81cfa6f5, 0x96d2b4ee, 0x9bd9bae7, 0xbb7bdb3b, 0xb670d532, 0xa16dc729, 0xac66c920, 0x8f57e31f, 0x825ced16, 0x9541ff0d, 0x984af104, 0xd323ab73, 0xde28a57a, 0xc935b761, 0xc43eb968, 0xe70f9357, 0xea049d5e, 0xfd198f45, 0xf012814c, 0x6bcb3bab, 0x66c035a2, 0x71dd27b9, 0x7cd629b0, 0x5fe7038f, 0x52ec0d86, 0x45f11f9d, 0x48fa1194, 0x03934be3, 0x0e9845ea, 0x198557f1, 0x148e59f8, 0x37bf73c7, 0x3ab47dce, 0x2da96fd5, 0x20a261dc, 0x6df6ad76, 0x60fda37f, 0x77e0b164, 0x7aebbf6d, 0x59da9552, 0x54d19b5b, 0x43cc8940, 0x4ec78749, 0x05aedd3e, 0x08a5d337, 0x1fb8c12c, 0x12b3cf25, 0x3182e51a, 0x3c89eb13, 0x2b94f908, 0x269ff701, 0xbd464de6, 0xb04d43ef, 0xa75051f4, 0xaa5b5ffd, 0x896a75c2, 0x84617bcb, 0x937c69d0, 0x9e7767d9, 0xd51e3dae, 0xd81533a7, 0xcf0821bc, 0xc2032fb5, 0xe132058a, 0xec390b83, 0xfb241998, 0xf62f1791, 0xd68d764d, 0xdb867844, 0xcc9b6a5f, 0xc1906456, 0xe2a14e69, 0xefaa4060, 0xf8b7527b, 0xf5bc5c72, 0xbed50605, 0xb3de080c, 0xa4c31a17, 0xa9c8141e, 0x8af93e21, 0x87f23028, 0x90ef2233, 0x9de42c3a, 0x063d96dd, 0x0b3698d4, 0x1c2b8acf, 0x112084c6, 0x3211aef9, 0x3f1aa0f0, 0x2807b2eb, 0x250cbce2, 0x6e65e695, 0x636ee89c, 0x7473fa87, 0x7978f48e, 0x5a49deb1, 0x5742d0b8, 0x405fc2a3, 0x4d54ccaa, 0xdaf741ec, 0xd7fc4fe5, 0xc0e15dfe, 0xcdea53f7, 0xeedb79c8, 0xe3d077c1, 0xf4cd65da, 0xf9c66bd3, 0xb2af31a4, 0xbfa43fad, 0xa8b92db6, 0xa5b223bf, 0x86830980, 0x8b880789, 0x9c951592, 0x919e1b9b, 0x0a47a17c, 0x074caf75, 0x1051bd6e, 0x1d5ab367, 0x3e6b9958, 0x33609751, 0x247d854a, 0x29768b43, 0x621fd134, 0x6f14df3d, 0x7809cd26, 0x7502c32f, 0x5633e910, 0x5b38e719, 0x4c25f502, 0x412efb0b, 0x618c9ad7, 0x6c8794de, 0x7b9a86c5, 0x769188cc, 0x55a0a2f3, 0x58abacfa, 0x4fb6bee1, 0x42bdb0e8, 0x09d4ea9f, 0x04dfe496, 0x13c2f68d, 0x1ec9f884, 0x3df8d2bb, 0x30f3dcb2, 0x27eecea9, 0x2ae5c0a0, 0xb13c7a47, 0xbc37744e, 0xab2a6655, 0xa621685c, 0x85104263, 0x881b4c6a, 0x9f065e71, 0x920d5078, 0xd9640a0f, 0xd46f0406, 0xc372161d, 0xce791814, 0xed48322b, 0xe0433c22, 0xf75e2e39, 0xfa552030, 0xb701ec9a, 0xba0ae293, 0xad17f088, 0xa01cfe81, 0x832dd4be, 0x8e26dab7, 0x993bc8ac, 0x9430c6a5, 0xdf599cd2, 0xd25292db, 0xc54f80c0, 0xc8448ec9, 0xeb75a4f6, 0xe67eaaff, 0xf163b8e4, 0xfc68b6ed, 0x67b10c0a, 0x6aba0203, 0x7da71018, 0x70ac1e11, 0x539d342e, 0x5e963a27, 0x498b283c, 0x44802635, 0x0fe97c42, 0x02e2724b, 0x15ff6050, 0x18f46e59, 0x3bc54466, 0x36ce4a6f, 0x21d35874, 0x2cd8567d, 0x0c7a37a1, 0x017139a8, 0x166c2bb3, 0x1b6725ba, 0x38560f85, 0x355d018c, 0x22401397, 0x2f4b1d9e, 0x642247e9, 0x692949e0, 0x7e345bfb, 0x733f55f2, 0x500e7fcd, 0x5d0571c4, 0x4a1863df, 0x47136dd6, 0xdccad731, 0xd1c1d938, 0xc6dccb23, 0xcbd7c52a, 0xe8e6ef15, 0xe5ede11c, 0xf2f0f307, 0xfffbfd0e, 0xb492a779, 0xb999a970, 0xae84bb6b, 0xa38fb562, 0x80be9f5d, 0x8db59154, 0x9aa8834f, 0x97a38d46 ]
    U4 = [ 0x00000000, 0x090d0b0e, 0x121a161c, 0x1b171d12, 0x24342c38, 0x2d392736, 0x362e3a24, 0x3f23312a, 0x48685870, 0x4165537e, 0x5a724e6c, 0x537f4562, 0x6c5c7448, 0x65517f46, 0x7e466254, 0x774b695a, 0x90d0b0e0, 0x99ddbbee, 0x82caa6fc, 0x8bc7adf2, 0xb4e49cd8, 0xbde997d6, 0xa6fe8ac4, 0xaff381ca, 0xd8b8e890, 0xd1b5e39e, 0xcaa2fe8c, 0xc3aff582, 0xfc8cc4a8, 0xf581cfa6, 0xee96d2b4, 0xe79bd9ba, 0x3bbb7bdb, 0x32b670d5, 0x29a16dc7, 0x20ac66c9, 0x1f8f57e3, 0x16825ced, 0x0d9541ff, 0x04984af1, 0x73d323ab, 0x7ade28a5, 0x61c935b7, 0x68c43eb9, 0x57e70f93, 0x5eea049d, 0x45fd198f, 0x4cf01281, 0xab6bcb3b, 0xa266c035, 0xb971dd27, 0xb07cd629, 0x8f5fe703, 0x8652ec0d, 0x9d45f11f, 0x9448fa11, 0xe303934b, 0xea0e9845, 0xf1198557, 0xf8148e59, 0xc737bf73, 0xce3ab47d, 0xd52da96f, 0xdc20a261, 0x766df6ad, 0x7f60fda3, 0x6477e0b1, 0x6d7aebbf, 0x5259da95, 0x5b54d19b, 0x4043cc89, 0x494ec787, 0x3e05aedd, 0x3708a5d3, 0x2c1fb8c1, 0x2512b3cf, 0x1a3182e5, 0x133c89eb, 0x082b94f9, 0x01269ff7, 0xe6bd464d, 0xefb04d43, 0xf4a75051, 0xfdaa5b5f, 0xc2896a75, 0xcb84617b, 0xd0937c69, 0xd99e7767, 0xaed51e3d, 0xa7d81533, 0xbccf0821, 0xb5c2032f, 0x8ae13205, 0x83ec390b, 0x98fb2419, 0x91f62f17, 0x4dd68d76, 0x44db8678, 0x5fcc9b6a, 0x56c19064, 0x69e2a14e, 0x60efaa40, 0x7bf8b752, 0x72f5bc5c, 0x05bed506, 0x0cb3de08, 0x17a4c31a, 0x1ea9c814, 0x218af93e, 0x2887f230, 0x3390ef22, 0x3a9de42c, 0xdd063d96, 0xd40b3698, 0xcf1c2b8a, 0xc6112084, 0xf93211ae, 0xf03f1aa0, 0xeb2807b2, 0xe2250cbc, 0x956e65e6, 0x9c636ee8, 0x877473fa, 0x8e7978f4, 0xb15a49de, 0xb85742d0, 0xa3405fc2, 0xaa4d54cc, 0xecdaf741, 0xe5d7fc4f, 0xfec0e15d, 0xf7cdea53, 0xc8eedb79, 0xc1e3d077, 0xdaf4cd65, 0xd3f9c66b, 0xa4b2af31, 0xadbfa43f, 0xb6a8b92d, 0xbfa5b223, 0x80868309, 0x898b8807, 0x929c9515, 0x9b919e1b, 0x7c0a47a1, 0x75074caf, 0x6e1051bd, 0x671d5ab3, 0x583e6b99, 0x51336097, 0x4a247d85, 0x4329768b, 0x34621fd1, 0x3d6f14df, 0x267809cd, 0x2f7502c3, 0x105633e9, 0x195b38e7, 0x024c25f5, 0x0b412efb, 0xd7618c9a, 0xde6c8794, 0xc57b9a86, 0xcc769188, 0xf355a0a2, 0xfa58abac, 0xe14fb6be, 0xe842bdb0, 0x9f09d4ea, 0x9604dfe4, 0x8d13c2f6, 0x841ec9f8, 0xbb3df8d2, 0xb230f3dc, 0xa927eece, 0xa02ae5c0, 0x47b13c7a, 0x4ebc3774, 0x55ab2a66, 0x5ca62168, 0x63851042, 0x6a881b4c, 0x719f065e, 0x78920d50, 0x0fd9640a, 0x06d46f04, 0x1dc37216, 0x14ce7918, 0x2bed4832, 0x22e0433c, 0x39f75e2e, 0x30fa5520, 0x9ab701ec, 0x93ba0ae2, 0x88ad17f0, 0x81a01cfe, 0xbe832dd4, 0xb78e26da, 0xac993bc8, 0xa59430c6, 0xd2df599c, 0xdbd25292, 0xc0c54f80, 0xc9c8448e, 0xf6eb75a4, 0xffe67eaa, 0xe4f163b8, 0xedfc68b6, 0x0a67b10c, 0x036aba02, 0x187da710, 0x1170ac1e, 0x2e539d34, 0x275e963a, 0x3c498b28, 0x35448026, 0x420fe97c, 0x4b02e272, 0x5015ff60, 0x5918f46e, 0x663bc544, 0x6f36ce4a, 0x7421d358, 0x7d2cd856, 0xa10c7a37, 0xa8017139, 0xb3166c2b, 0xba1b6725, 0x8538560f, 0x8c355d01, 0x97224013, 0x9e2f4b1d, 0xe9642247, 0xe0692949, 0xfb7e345b, 0xf2733f55, 0xcd500e7f, 0xc45d0571, 0xdf4a1863, 0xd647136d, 0x31dccad7, 0x38d1c1d9, 0x23c6dccb, 0x2acbd7c5, 0x15e8e6ef, 0x1ce5ede1, 0x07f2f0f3, 0x0efffbfd, 0x79b492a7, 0x70b999a9, 0x6bae84bb, 0x62a38fb5, 0x5d80be9f, 0x548db591, 0x4f9aa883, 0x4697a38d ]

    def __init__(self, key):

        if len(key) not in (16, 24, 32):
            raise ValueError('Invalid key size')

        rounds = self.number_of_rounds[len(key)]

        # Encryption round keys
        self._Ke = [[0] * 4 for i in range(rounds + 1)]

        # Decryption round keys
        self._Kd = [[0] * 4 for i in range(rounds + 1)]

        round_key_count = (rounds + 1) * 4
        KC = len(key) // 4

        # Convert the key into ints
        tk = [ struct.unpack('>i', key[i:i + 4])[0] for i in range(0, len(key), 4) ]

        # Copy values into round key arrays
        for i in range(0, KC):
            self._Ke[i // 4][i % 4] = tk[i]
            self._Kd[rounds - (i // 4)][i % 4] = tk[i]

        # Key expansion (fips-197 section 5.2)
        rconpointer = 0
        t = KC
        while t < round_key_count:

            tt = tk[KC - 1]
            tk[0] ^= ((self.S[(tt >> 16) & 0xFF] << 24) ^
                      (self.S[(tt >>  8) & 0xFF] << 16) ^
                      (self.S[ tt        & 0xFF] <<  8) ^
                       self.S[(tt >> 24) & 0xFF]        ^
                      (self.rcon[rconpointer] << 24))
            rconpointer += 1

            if KC != 8:
                for i in range(1, KC):
                    tk[i] ^= tk[i - 1]

            # Key expansion for 256-bit keys is "slightly different" (fips-197)
            else:
                for i in range(1, KC // 2):
                    tk[i] ^= tk[i - 1]
                tt = tk[KC // 2 - 1]

                tk[KC // 2] ^= (self.S[ tt        & 0xFF]        ^
                               (self.S[(tt >>  8) & 0xFF] <<  8) ^
                               (self.S[(tt >> 16) & 0xFF] << 16) ^
                               (self.S[(tt >> 24) & 0xFF] << 24))

                for i in range(KC // 2 + 1, KC):
                    tk[i] ^= tk[i - 1]

            # Copy values into round key arrays
            j = 0
            while j < KC and t < round_key_count:
                self._Ke[t // 4][t % 4] = tk[j]
                self._Kd[rounds - (t // 4)][t % 4] = tk[j]
                j += 1
                t += 1

        # Inverse-Cipher-ify the decryption round key (fips-197 section 5.3)
        for r in range(1, rounds):
            for j in range(0, 4):
                tt = self._Kd[r][j]
                self._Kd[r][j] = (self.U1[(tt >> 24) & 0xFF] ^
                                  self.U2[(tt >> 16) & 0xFF] ^
                                  self.U3[(tt >>  8) & 0xFF] ^
                                  self.U4[ tt        & 0xFF])

    def encrypt(self, plaintext):
        'Encrypt a block of plain text using the AES block cipher.'

        if len(plaintext) != 16:
            raise ValueError('wrong block length')

        rounds = len(self._Ke) - 1
        (s1, s2, s3) = [1, 2, 3]
        a = [0, 0, 0, 0]

        # Convert plaintext to (ints ^ key)
        t = [(AES._compact_word(plaintext[4 * i:4 * i + 4]) ^ self._Ke[0][i]) for i in range(0, 4)]

        # Apply round transforms
        for r in range(1, rounds):
            for i in range(0, 4):
                a[i] = (self.T1[(t[ i          ] >> 24) & 0xFF] ^
                        self.T2[(t[(i + s1) % 4] >> 16) & 0xFF] ^
                        self.T3[(t[(i + s2) % 4] >>  8) & 0xFF] ^
                        self.T4[ t[(i + s3) % 4]        & 0xFF] ^
                        self._Ke[r][i])
            t = copy.copy(a)

        # The last round is special
        result = [ ]
        for i in range(0, 4):
            tt = self._Ke[rounds][i]
            result.append((self.S[(t[ i           ] >> 24) & 0xFF] ^ (tt >> 24)) & 0xFF)
            result.append((self.S[(t[(i + s1) % 4] >> 16) & 0xFF] ^ (tt >> 16)) & 0xFF)
            result.append((self.S[(t[(i + s2) % 4] >>  8) & 0xFF] ^ (tt >>  8)) & 0xFF)
            result.append((self.S[ t[(i + s3) % 4]        & 0xFF] ^  tt       ) & 0xFF)

        return result

    def decrypt(self, ciphertext):
        'Decrypt a block of cipher text using the AES block cipher.'

        if len(ciphertext) != 16:
            raise ValueError('wrong block length')

        rounds = len(self._Kd) - 1
        (s1, s2, s3) = [3, 2, 1]
        a = [0, 0, 0, 0]

        # Convert ciphertext to (ints ^ key)
        t = [(AES._compact_word(ciphertext[4 * i:4 * i + 4]) ^ self._Kd[0][i]) for i in range(0, 4)]

        # Apply round transforms
        for r in range(1, rounds):
            for i in range(0, 4):
                a[i] = (self.T5[(t[ i          ] >> 24) & 0xFF] ^
                        self.T6[(t[(i + s1) % 4] >> 16) & 0xFF] ^
                        self.T7[(t[(i + s2) % 4] >>  8) & 0xFF] ^
                        self.T8[ t[(i + s3) % 4]        & 0xFF] ^
                        self._Kd[r][i])
            t = copy.copy(a)

        # The last round is special
        result = [ ]
        for i in range(0, 4):
            tt = self._Kd[rounds][i]
            result.append((self.Si[(t[ i           ] >> 24) & 0xFF] ^ (tt >> 24)) & 0xFF)
            result.append((self.Si[(t[(i + s1) % 4] >> 16) & 0xFF] ^ (tt >> 16)) & 0xFF)
            result.append((self.Si[(t[(i + s2) % 4] >>  8) & 0xFF] ^ (tt >>  8)) & 0xFF)
            result.append((self.Si[ t[(i + s3) % 4]        & 0xFF] ^  tt       ) & 0xFF)

        return result

class AES_128_CBC:

    def __init__(self, key, iv = None):
        self._aes = AES(key)
        if iv is None:
            self._last_cipherblock = [ 0 ] * 16
        elif len(iv) != 16:
            raise ValueError('initialization vector must be 16 bytes')
        else:
            self._last_cipherblock = iv


    def encrypt(self, plaintext):
        if len(plaintext) != 16:
            raise ValueError('plaintext block must be 16 bytes')

        precipherblock = [ (p ^ l) for (p, l) in zip(plaintext, self._last_cipherblock) ]
        self._last_cipherblock = self._aes.encrypt(precipherblock)

        return b''.join(map(lambda x: x.to_bytes(1, 'little'), self._last_cipherblock))

    def decrypt(self, ciphertext):
        if len(ciphertext) != 16:
            raise ValueError('ciphertext block must be 16 bytes')

        cipherblock = ciphertext
        plaintext = [ (p ^ l) for (p, l) in zip(self._aes.decrypt(cipherblock), self._last_cipherblock) ]
        self._last_cipherblock = cipherblock

        return b''.join(map(lambda x: x.to_bytes(1, 'little'), plaintext))

ISP_PROG = '789cecbd7d5c5347f6383cf726379720281a2028b145224459cba2a858b56c5042145bd7fa02ad5b5df08288c51704a4b66525249718d1a2bd60a2c12dc50aca7ed7b5528df52da022addd76ed8b62bbd5a201028a0a1588585e9e997b6f78abddefef79becfe7f9e3f97ced67987b66ce9c3973e69c3367e6ce4d271c7974e1efb7318081a1ffd2968484a42df1834989d274230e009393332a6dcfd2108d128bd04460f334f3b0f99af958a426125369545894260a536bd4d802cd026ca1662116ad89c6166916612f6b5ec65ed1bc822dd62cc6fea8f9e3fe3569c578489a4708580640ebb7302dc3600ed3321ce6302d13c01ca6654298c3b48c80394ccb443087691909739896b9c01ca6656298c3b4cc15e6302d1b01739896b9c11ca665ee308769d94898c3b46c14cc61327e08c7a4a9da29c5c540829ff849b205ef4e0b50b649302f108e8dd9bbc92f6441fc68efbac7fe7ed3a91f713c176f1e4399703c7ef4b83ae3fb481e78579a5cd9365270e07d9c9a80694fe080da81839c3513b04dc0cf370df885a0672c5554efda34b2654cab77fbb827cf7597d495d697371d6b39d17aaafdcc930bddf3ee443544372f7eb0b42da66365d7ea9ebb771a1bee353f7cf0735b67c7d3aede1e851fe6a19838da433169828762ca540f855fc418c5c457c72826c58f514c491da3f0d3782a26eef5544cfad05331e5634f855f95b762e2d7de8a4977bc1553dabc61fbb1b0fd58d87e2c6c3f16b6f785ed7d617b5fd8de17b61f0fdb8f87edc7c3f6e361fbe761fbe761fbe761fbe7d302fca63f0ef098ee9aeb89532b08f0c86ff3b2b1c58f42f604a779784d2f899b177f371edf52b2655edadd3451426942546263a2686be9d6a8ccc64cd775e5eba293ef25bbbe5dfe76f43bf7de1999722c65f186871b46fee5d85f166f7fb89d8463d3fb693cc809d868fd04cd68d21f1ba3f7d78c21e598442fd748c88998a77ea2c6930cc0bcf4011a2f3210f3d6076abc490526d52b34527212e6a39fa4f121276363f5933563c9206c9c3e48338efc1de6abff9dc6979c82c9f4533432f2056cbcfe05cd7832187b4e1fac798efc3df6bcfef79ae72518e687e60900384b75aef5639abc5bc6b53ed7eeff24b0bbbcee58fd89a6532d675a2fb45f7c72a53bfacee286a5cd310f56b6adee58d3b5b6e7de9d870d3f37773e78dad6dbf1d83f04eceb7aecef317d5f0f5e222a752d1f796ccc09ef53e3ce3c77a1a4a4b4b4bcfcd8b113274e9d3a73e6c2857987a2caa2ffb6f81f4b2b622c2bcfaeb6de3dd45876ef6f0ffff17345a7e5e9d95e2ba75bf36e3a750be995fcb83f302e01c09ead7cc0d7df70d60b3ec6011effd596b43dd3c043f877cc748b3f00e61c7c07b2b49c38fff8796beeaec1d34ad2e6a5df4d1725962646ad6d5c2bca2ccd8c7aabf12dd7e4f2e4e8f5f7d6bbbe53fe4ef4bbf7de1db9e1d886c51b1f6e1cb9fdd8f6317e27fc964ef879c2986927a62d0dfd39d47be2a98931019d01de334fcd8c09eb0c1b37e9cca495939f4e1e37fbccec95739ece796eca8529ab5fe87de1b9f00be1abffd0fb07a77423468bead302956d463de45caff8671155b5d5f4c78c7c7a2d93ebfdd58a7cd3bf4c6a499214986a6eb2f9cd9a027518d9d59725ed7aafa0e63b7546fecd9a9b8bd89a2f50ae80b969d136b309fe4590e90b5a4dc93a01a1322a918ce2763cce8c0c49034b3c3aac460f5452f971491ca68ac072b2a585004888866b4623e225e91a6528035201c896080efd83120800ae75e21cfeca0873860ef8cab07b376d50575477e09acf395cdb7f3971111d6d8dfd0bfa111a2504606f7e4f8d24c866f4fa72c3177c7f9fb3353095c4d16a2904e484e333c40fa4c0e2d694edbe14319aeb91fe8a6b455fe129b2ed2230d8374802da4ea90900c182d397c7abe748498c1b494db511966a3ffbacda7d411135c7c7070b4d22314c61bae4abefecbb7989509b6aca0ba9f12771f8f4c53f9769027cf504a0da4f015fbd086854be3484a8069cf12271cddefd7f0dded7d62b3f4202f94724c05439d904215077f49dfe36cb2a38428a4289538026e480c0ee58386e6e9ee5b8a117f0fc9ce3ca3f3b07b931b9f47323ff488a413ebc4f0a772d9390003f4b5894c1fa617ca40cf041a883f799be901000a7efed8d32c57ae5d99eab7d26671916c495404540ce8e7c9b68ddb50c519ce3725249a5df04bea40ba2be03525fd70438eac1fbf6ff758325d405b65ae082c6534c925d566cf47ef5240057b3285a256a910bdb0037ab756d77a10e11f1dc9c33fab26345942fe994ad67c427df2e87c9f4c577cb3481a8672afd06ec158e29ca9786d0c606c078c35edf1ffbd75385a94346c04a94be0e681192e8e7d66da9812d3db1e5ba0c957faba85deed906a4e9501f84425ebfc1f70df5e39dba7efd25fea9b856a30ae09f2b6f7dac9aa03286b0dab8ae1a95b3cf71497b5593f9e7e2b585aa17f8e7bac4fdaaa94efcc483aa194efc04591cabade18ebf56b17a7b48ec28fa90d36017c75faf734f231c45bc3d1d2ca2c4507a37bf909792b8738c50c3519d1b8bfb92c3a489e24acae6615106155b3ad361e2a49cfdef92cd78fadd044ca582929eec1c71cd42fe49f9b90671ca8dfd5fb214b6f51f1c05a8ff4379e4fb47398e5c1d05dfab0b2dd868ffa64275902e04b8d234379fc0399fe09f5ab506a039958376302f01cd2c365a42b401510bcf4bb740d506310803aadb966a50cbddda803996c00ec19c89a501e3708cf22756ed16b5fbb706d74fab938fffd049fdc792c49cb5935c8273f7aa78fdf99288e4eb9e6201b611742f1a29374e6c344366f7205d63a90b87516f917b39e966dfe074d34935fb33a756221a403458632bbf75ea310f573b7157a596d42d6e5fda1ad3b2b269757d6e7d6077f4937243f0ce693ac61578484600dc98076728effe5fc42da571a284bbe9f3b6956cc3dfbebb7ede9b256f62aa78488371748d9aa37faa3ca3a7d2ea4189deac23c1f8a24003956e061231748e9611e01b7a31ed2b12831c232315e31ae6ac6e62c459f18b58f8813bddab2ce353973e911c10e131ed2b5bd7344956dec3a42950cfdd765d14bfb9777d49d3d5bac5ddab5b725b4aeb8374c186138653796b0ef88ef0f537efdc3981fa400c1ae3a260bc214abebb6ddedb256fe3efdc7d735e0aa60a40bc41cf62d689a17f0bc31821c00bd5d4c34c8156e10aee1a73f4bbd59ca485bca4754022d5b1d2fe3e5feed5064a73a3e1ac4d724afc28631442de038ac2f79f35ec57be6ef9fb7fd3be27562ee2a814aa365819f2b820fc32b7f625bd594049e19340ad7ed3a03e6bb403692e84a23a9390f7ac01dfe773f0da75040ffb5fd1288a2ecacb634605e65ea59d3c294f9fb440ba23c22f9b61cfe15738eafa4427f5a4c4c1d4bdd70ca59ebbc6491dd166480f7f7979e74815a22872725a13b7075a327ad6d6e8e38c34ccab0b571d8c3a2b7580b3fb4e81ebf946484b7be5caaa39d25a9e4fd9457950cca80fd188470ee5ccfea7016a657fe2a89d7cedd7d41a5fe3a871b4d68e9a6aa1a3b855efd02d0bf4e0db52cb8d8bebb59fea81319395a73aba49f02909909f0c6cd12ac458900e537598e593ba8056b11033d74a019df7f1238bd005aeab97b19242de02179b49b812d490c2c002d9cbbe7a29c8916a189f7f7e65946797019f97ab92aa48aac30ea06c46caae21ba988ab12b00a2cbf9a779c925c9c87205010b8124a363d442ebb6585b91bdbb822c007b92c24821184d32a248e06fa4c6dd007bee9bec88fff002f9142150594df70becd55664b11eeea216ff26e4e38374bc95be68e8d7bde297fc69fe698d99208013f29bcb8f23ec6e1ce7b92cb1a5de663db979cef5329c934dd90c138cb3647fecc8cf9a31cf2b62efaadd2effcac9d6d67801410d014ac8eff3cd7afbcfcc3e5250f5be979a4aae7d4e9a04ad8f54ec628c81e08cb168feb654ffd6c096e82651fbe2fa33c613ba605d9021472fa82e84b34803428d7c93b6e630b848a2fc24b84b7e0e678e4a7780ddb12b8a050a3110e7113649876314ef01dfc702f6c62e6c80f204ac34fdba8026f6ef47641186bcae5a7e449ff05228c302b2babeb4a0ba2fffadad5901b5430539af869c5fcfd75e4904925c1a5c14a1e70c705774eb3d6dcd75a00944e312d43480796cde012cf4e9070c4d4c5b43aeca9fa0e8891dfb88a971f451ef75e286d843d9edc36753250247f327a87c6f22bd394bb62a1fe457d49058d60c8d22a3831065855559b4ea022058a8837c54d8159860e147609eb822a90b967d02d6884393bb0036197a3b4115b3ff5f787ac9668eba74051b0766aae2797dae8bc808cd38cacf735c31bd90b76c135a1b66f469d5df414bbd0c18428895905fe70ba2ea41343d4f849edac11ad1aaf7b0405e330e659c17c0b16ba16cfce128b570f417d9bc03ce08b2a5d16a4a6707742c66ddc1f7927d2bfe245ad138aee84d68fd4233cd539c1d26720112512eae51496984913889aff1e3ecb94cc1b54cdc20d5bb00799823d0a98f9ceed9dd8b285a25213c70d3a28c41713a1f5574a01aee39bb0df9248928cadf48a0d897b8385057dc4e27419dce7e5ca60e799c240ce1fa3cbc8e9754885407b9147ef41c23f4eb911a609db879bcdb3aba41b6e4c14fb2253dff4676843cb45cb81718119fff2065fcf847dcb16aa11544d32100f9f24342cc39135fb1d687b08f93e3f851bbbc628511a89b743e9a39f93914e9c3d8d58df268c025c471773efe3a23212addd9389dc53bf4a9843cee6ef369e8e5eb4f4b886beed516ceaa44ede53a2cd20cfd0465b7f05a8834b042af03826a1204d713429ed7ae92c43bd057885a82ea83ebf832474ea27f22cff12f3042e1b54ad089f82a8aa07c1b80c64eab8baa261c911713a02b369c8691b29ad2db81218a7aaf16ae513d16b394c0108fe65a32c2e6d1d06b505741df5de94e79770053155c43dd9a2d8ce89a7b4fac6df4f56e5472dc3dd1fad2fc203d957a0967321da0ca76fe0eb355d4f7d2ce33fbdc6c6ef608d2b6a1b677f45d380ed125e54e113a37dab72f29bb14c8490b3824b200394c870898c374480873980e09600ed3211ce6301dc2600ed321007398e07aded1318ad94783ebbb997d04c6fec5afef7eddc2ec5300ae8fdc1c7b76e0d37dd955d2f1f9e1fb6ca9979e1cb4bc9e5ada52ae0ba64b606c96dbce7bce91c658767d535da8a3d517ea653e2589e12d0675f8b5730b82ba0922f849507bf6babdf640ded366fbbcece2dc5756925a8570049da779a4856b3fe320fdf6db2584d095abcdbea6950a31895121a05e21813809c6023eed00b5d8960977b2f9f249edae8174884b094fb9726ccff2d1778e46fe279a7edf2d55bdecc23dd7f5956e16a507d28d0989680fc2adabb7cbe91d14bf2f6c2bd7d3a4007ab70d7da1749932cb2b273b62b47f9d08464f729f93403eb61ac84308209f0ed324c2553e17e67e042e9f48e013a234d05a6957deb2ee1aa5ac95b7cbbab9a724c7dc3afea97b6e3df7a4ef034fe636215ef18401ad979f337ab1bb664f8eabf92f711ea4fa47befe020fff9b8305573858f56f677b1efe81afbfec1c033f1f3d731768bee07b647ba07ab8dd84fdc9dc16970418db4d6c5fca90ba65f259ed4b519c2c0f112ee5db3e725947441de6a3e1e2872e29e2a8cf9db1f1035a3df7b3448b6cbdc6ae51236bd1d612d8d8d49227575bbf69caed2e6dffaae546fd0f75abbbd73c59dbbebe7563cb8779d376a215f17a4dd186ea1a347bda175d81c4a100d418d203ce6834954dfa602acd226c1105464c123f58997b54b59ae64e24e27650ee4420419c75cd8888d945a5fd095bb9cb254e96e2b9846a2f0b8c8c3c59445dd3296ed381b93cfefbb2b8123a9a2e35caeaf89240ca87f038bbf380925051fb5d01aae54f3b2666356bc35cb15273e808b3b2426754ca671d0027bb8f160fe080a69ed8a9d75f38a23d2306da4f0ca04adc73b334974a33831f72e7c6b9bda5098cc98da6738c544cb12ba2557ec0b00b69957c5639d8d6a551376e8e4a2f4d176d6b4c8e5a5fba5ef4e6dd77e6bd5bf22e9e757743382d86fa193602646ba235919245232a5759502f82f3a897c8c852bd4decde2b80f2728963b6927e548ec883da70d0053e2ff8fcaa70895bca596111eebedbec4ec0591d0fee19cf5e2e10501ded8008382b3c8c493249e5aa4ba56824dc9af39c57c3c76a144bb016642785c8ee7a623fb5221e9845f7fbb057248b7ee9737fd9f0f2428b5bcac6dc20fe9ca6321571519224c974582449a48bdca71ec85a84d71e1acfea3e8990d5455ebea7bfa7a3d27ac03dbd4b5c78ee0d3a9c6f99bdedb5c892a4f11fbc76d927ee0c9c1156da0742dd0ff64b5bd3dd763e30d7c9a35f56b97e559b5b8a53fa71fe9cb53b1c88578345964235940138f7efdcc2a9b483e09e2e10f6c673b9e58dc8397aa35216f7da6534fbaffe32308b7ea2d7bf9e6cb9a7a71eff0dfb417fb6a6169f05e70ecddcd9dc5a1c3796eb6cf38b3b1b4e6acf42f99f35004c55252e3c6b76f505a915d4a21f019ae9d5ec3c43cc45c53f649d5f937b9bef57f9e61b91777567f5fa88372ecbe2eea29ecfa27d6360f7c0be31fac9e2f6a09dc7763242622916492ceaf993a1c59ffef58e11ed17059f420b39aa033d2f52df89812eee7bab36568c51effc02b4d2c918a5cfc4aed24be99c030b7761132562035ca1c7a7e6b6943495d6a37de0d2276897b8ba654dd3da7a469f01d7ad3a9c7adb8133ed649f059da0a1a8aedd887fac965561aa67ed0c4b52d89d21dc0dda1e7ed21d64e067329e21373f6fdc063d8841fc94aa330a99dae940a3407b025fa9148c24171b41122322fb28efef00d864505023f54259824f8ae7ba367389d1f4d0f3be29893dbdb4c7174b6a0be09ea155807db1574d35d85d98da0460d6eb05c3a811645f968a127f027c1252cda122a3925a5aedda13462b049f88716306f29faa9f29fc130f9f849e281ee3c72b2e8cdd13c8ea2b4405ecee477eaeb695cd3fa96d6592bcc1ae87bbee1535fa1b3d6c4eadab5c0ebd3376fdfcd7881760262dc461b8be2b09ca0e7736b597216776d141b8eb537a7125edb02493dc6b6544ca150c5947da1a1adb99da8998595f43be64f54ca11688806c5dc1a3a27b15643d986c99a99b61356e851c584e35b1b9f55423c2f137ca9218bb14c8ec0721add6e705a70d80badbe8edaec514be310a25a1a0a390342af65d612552d128c2a4a87de88dbb9e9404cadaa3c5b309d8b21ffad642ecf9a1121b1058208d3549a28aad49607f639b5924404f7b150db7b3160f483742bad8387b47382d98be03a3c60ac71201ccd61920c2a5e129d31906a8832219a2c3a81ff775e54b91ec663b7e4025220195005792b10219b4144cf0491e60debedc47d90f8050fd01658f9afad21ec445b6ea2da89d84ac49caa63ca99ed8d05d7fc2020b66efa40e76fa488442bca4df2fc565f5c406e551a33afca8741aa3cc732618df85bbd05d53b60acadcc0840f8c9930c62cb7a753de295246fab2807a9ff4d65ac4584c8124c11364dbb97ed4ebb510db87a2b63a00cbf18b8e755c8d2219966e76c8d8d2698e752bca253146b0378aba7345c8c42401736eaec037d71bf87a7b8391a2c5fb2484a8cf630de5532d22d4e61b81ca0aef5ac04a1eb59f597bd5a5c5a309348387a927bf8ea21aae00b3e8145105e33fa42f570013530329368ab250891757e280255bc954181b437d11417d49ae7ec2c4283073ee15f2758bc77a4a540d3cd7b61db0bd59dbebb25165f14cf048693b50b1639f92fad373024e9b65eb42e18eb964df9e47b27bac367f6cbfcce69fda2f32761fe0f6c8edbecc2e3fee8dbd50417de102318bd622dd2a6a94ad436d469f9da61b7b3e42eaf9664f98edbdc63af7f37b159c6e34dc6ea828d7dfb2124959e4ec829eccac5d8527b5335de1ca40edeb7465fb389bb448f2ee2f40a3a6446ea04a5d017d5db899480cdd59065616647955647e04425d9f2a43df2e07dff4cf6bdd9f2185b11d702f4e116e305271ebf32fc4a2d12c8512891167f56a2ce88014cded14478c64fd38ce56cf249d944f5f84d972e7d8b2d4d4c65801ad964f879e0fce7751529b3914fa77aac108a0a67d6617f6dbafcff80b15645ec4a71fb0f4263a961aac5a4b1e90e876f64698e8bcaa7cf927bf80c35115fa3c50602fb86fcbd4ffc8d023b0fe35fe5cc659e85130de6f4039b356fa49e77f692ea0883a681fe559cd9e406bd504b0edb6f412448fa502eee80fe68592d5700771504d3dac01e57a6a7383abf60a016892260ee5d7f6daeed97ba12fdd9a01ebf65e1d5cc37466821e0bb355df27c9157553ad35226d0501b42768a0b51298c04a63da0b042eb840e3820a42a03d4d0b189a16ca8f6702c169ba4ffe492c909f7660f273764c7ebc5620ffa446203f9d84c3a85000234ea1fc1cd99761d913ff21f921213f57d36bbb0f79a9b777e664538f0f0b2b72ab01b5fd3acea83afb34ea1e29c574c0bd43a8be13081690d0926b4090510e48ec962554df01b451b08cec809ccb412db0493be18834ea06ab34838d3fa74b43d97854c2c3a11c2cf01d9f5ad294db12ac1bba2e9da0c7b6442534c60d5d7502f87dd925a67ce7343e76887b5a92a89da9eb831e16670c19183342d827e9bad2473d0d13a0954cf28bb88f5bcd920430ae297e0ab068b49e2da587d3cec94627b5b68d67bba9d8e419bc5fdaedf16685fe7798298972e904920c7b5f78a14b226198f020d55c216e069447a750428cc0a92b47853f982b0cc9119c7e66e631cd63a16ecc8151acae2f86f6dfc9748d0515cdc9987ceef43e5e1f1f1db652579331d3a6a2374d8f64f76feb6694a077fef44e6aafc85f3b5dd857a1332b05677440f2f6d5bee803542ee95321566394acd39521619f5f75799bd615a54844863ec94e21267b64ba2f21b38554628d0b23da8c7fa3a77aae00595c51932ca1a805aecb02ca56238c10327a21ee1367b2f92498ec3eeb4cf72bf40918e21c9d57c95f72fc85e33c0c2b4aa0f32a9a9330f927d3b118e7feadfeeb93b27545adb294a2768a6c446f5170484fa0b2ca36c36741d11341189c0bbd5068ea4eb596c008849fa57f275ba92bc9ee68ac2cbfb410436346fc23be19c4775d8dab84dc8c53593500f2d704f96b9120ae3721ae610b5c1627bb234b9035c8d6c99a4d0915b9c9115951445e857e3a466dbe31ae22f93e40bc56d00918d3e80d0a1a4c4955440ccd4513bcccb73b4752578b6476eb2c9440ab4f8a098ea6931d0dec47108f46430b85dc88b4704445ddaf5a9c3bcde2af5eb550caf5e2a214d33ae758fac7f0b046f8cc316ca801bf1ec3378617accfeabfed19fddf19e8ffca1d0b1c456b5f1f8c58a9a09d369c6844381292e8eb32df3652263bd0be48f7315d9ff75dddbfa102f1c8f2d658236279db5e23f489f3b9e393e0d3c0f246d5e01212c6cf248179520536cfa402bbcf9ba6fb25b453567129d8499f753ecd3e293e0f583e4938eb24817f8ef8248502599b673a84059e1d559672bdbf7e83d5c96bddd90dd6ab86f11515cdcdecdc3863bbbf9f47fbd0205d306db4a3759bfc4454cfbf9b9accad07a89cd1d75414cddf7b495659128727a0f7bba855b04e5b1880417cd62b17efa31612e08d75e5c6379a9c58683790c59d12c0fdc0030bda7b3a4f5f17d78bda1907e951ae0bd64d339c3218be40d40c515814afe1ef0e6dadf59a88a173c7af72a3734b92e72507d2e864893f1f2286f0c3b57fab2716ed8328df0ed093d9c353717246f3e7180b9a7a2ca81547c736c6298d13f4cc5c56221f921f3925e2f7fc608994950c9508369a8ba414df06d697eb7650fe4d22e84dc756cf5d68b0733aa2c4045238bb525250c5309d7af0e943a693c40c0f0fab8b2ae13e4d88f669592bd0c977097bf6bd378ffe624a8ae64b868c2429e8d99d6737e065f95ca11049473e51081887a5078d449602f76bec4e510f38783f7bf62221811f94f3246a871deea59d34ea36b3750e29206a644be48142804e8565dfc95230d5f93ef6c4c741baccf8b773df79d862c8c3d47b6d3e4b5ebbdc661da233c5e4fb4e0965b70d96907ecf50096d4b759ec79eac42b33e5836d98f52d03d07f67cb4f2f66f9c1d7127ab6588bb83360e67704de5b169aa14c063fd802d7ca57860bcc5ae73d70519f6d7b8bd158876ffcb0890f53a4fdd0596a638f194339f25f1bae948e253ded57cee2ca90c8525228ef7ca9f102f721f381742a12b9dc79eb27127bd87fb9f4c1c2eb83dc0a3f21a3a1f8da6d1493a3a23d51a39eb901849410483ce529195c09803206951ef8b3c88240949667f9f6f52c94d1d807aa50e9c7e9d8aae83b1ced0f3fe590959b582a3909f7d610279b110503f885c96ac43e3dd9bb7bf461639febdb929fb2fcd7d0de6096e6f69a2904c7a62b531d05ac677802265869a4a74b884914a3f820c8d750022ef857ff564327ac7769f948e7cb391c4d0d9aa4f1dd20ca483126398807a8d4431a8276abfd7b6a0694a8abc782276feebe1b2f4f343b2fcd4e2f6161645c39e71d87350ae6d4c476791f2d39f60cfb41dbcaea60aec42d47ebc85b18b580dcc5a31d5aafd94c66c3bc5ad824f09e09e273f3e039b237e3142a31e6d2b7af58dcbb6557e8fd0ceff6aeee25c7696d5c5fd672759d6f2fd73c447956d56e7397574d3701d54d620cdc2169ebc34a08be0d46fe8a21fab057f19d0b0ec7a841964f82dbdadd30dcc7cf1f1a1333fe0138375a276b8874f46fb76432faf5f09289e269274490ce9e809d5e9956da6c082a9d9599ed384d49fd1fb139e7f6ab81e6854fda749258846a9d136aea3bb82c8563acbb38be19c8defc00730e33e1040cc9ea80ab24169fbb6f3298aad99dca8dc8235dcded76bb7712bb4faa3a5fbe22d88a6661753ef097476b4ef83eb4461d1fc687a0ee491dd0796ea0b78fb7e9d50155aa85ce239747721b03e48774c276ae1c717a33d0963955c619f3411c5a4c423c6d1d0179adb097cd60a6611186d483553e33f139e311a9a051661dffef7f6ac3f63346df479e8715f02793235b211d3f4da16ee4d1ff92edc41b6d8f977a965ba5d94f3fd625db33f3d2fe16e1cf2afd2c77d7d70e558e2d3882d28bca33d29ec33ae83f83b2635ed7eef9871d77a6aa797587b3a17c6ec5e98fcf469504134825d89b4a1b0e18cd1673d35de45644c644f841b28a945245d8bee6bdca867f3b01bf5a687a67bc4028e3b14a9cb6c3689cb1309d9fa3c95e0104a6ac300776640ab2b8c35c023f1eb7cb66578e76d33290566a314bc47961b4d942497ecdb0369c168e0d15e0bb1e0ef568f8d1e8f7ceeadb2486e18c16835150fe39cda24e04bea05be2229bf2b0edac770bb6253b58856fbc62a94a1463b9025aeca3722499db5dfdcf570cfbd8266cf87d5e75f85b65e03dba35db1049da224d500492d2ab1c35db1049da2b0250e58920977c50cdc154bd0294a73f51349ad02f3256bb85d31dca5f8ac4d35dbeedb7bdde0ae988b11fad7d25aa80d7f23839d2b457111bf52d422adb1bf3074a598911ad8708c5dcdfd9b450fa6e9a81fe15eab16ae77c522803c36fd88218172fc91109799ceddc79892b5b63f12dd3fab5f4a2212bbf2c549fbf3190bdc4f5f4498b23aa855d9938be1b3505687a9eec545279427b8c773a7e1c8fad07bf6e826435eb0cef02f864c276575b2165a2dbbe6b427644dcb4108f4c4fc3ad15992186408745ade25ec01bf66fa6d73b499d9b7c0d067adb21aed7d300a2f7bf75c0bf2092e752e2dd01bb9b0914892ecdafb6afa128a6bfa7d8818fb1ce1210a52960282d0bb57b9cf44acd0fa2b899690e39c12addc3958a2353ebf8ed7b8966cbb52d21bb6e3fcd2bb83dba9bd9edd8e9fbf31ce56cabf0c99bfd1435ba1ff4612c65a3476c524a4c7593f216f84a9a669712d7ae7b7b01969227a5f25851424a47ae484e2bda4fc18d96b7b60ef0daee7fc6b763bbfe3ff453a83f50c0b79af1cc9aff28b383ce57d0e4f398a879b4b12a537fafa24a2c0b598ca9804793f492eeecff9778d3cad0897a41ce3756b101fc782111c0dd0e07c1359f9589a8478d447cba8b65fd0fd4b4cf5b5656cead5d6af5a820cc70c5215e22d608f51c5fa83f772bb4b9e94b67fd374a3fe846e26af2f207571ee559ac3a4dfe3e96e322e64fdfc5fe1b8a2e1d3ce7bef495c3d70c1691d7b82521027382506d17a33d10577aee2c9ce3d006310e35542dbf8853dd285e8edb0e10c1dc9b55fcfb6f78c13cc12a3fd2e58d631f39a592f04f3bac39fcc6ce765e62f982986352f5e33d3ed7dd35a829b825a794df05bf3d6c54c3cb364eb9ab5171383eabeda11431b26f2fc274ac4623c42687b3ff21709b167191ff36b2570628c6ad6cfee3c6314549000d716a94c1bf6dac45f6a1ba1ef5687c674e0d45b37c0e1059afb451bc6e79bdad0dbe05abcc152016b0410c7778708846674e015b570ff230202ea47174cf0190124a2cd02c95b0b00e589deda6f2608f2e3bf1e1a55db9b68fdffa687cff3f7ffab6021ad1e5b7c56df89cf81b46cefdee83dbcc06077f632e7b50e7ccfc23990f2c5dcb3ff87b43fb7ac4a5dd9249823c297b6be314f10940bfdea08505237c7f59e728eceae14a8af00746f6d717b4c4b6efdea7aa4612774dad9b9d8e84b59d3b5354260c8db5b53b420424dedb58bb64da7962bb139c2c888a238f30821389c77f892b6fa32d85f154de7ece7b00f5e62b13fb00b1902089ce50c914dc068d006731295512a2581ca7d5d8580ce3b7a3fc67cb87882dab6d7fe346b3af2fa0047583d736c8b36f7f992ed7d257a6a991068d473840ee5360bc4dc63ef46f457589dbd64cdceb00c3cdb16297fd52ed5caf69cbb1ea35db5d54ffb1e7415c54d5063130fe7513976fcd9ef5b9c9c644db72dcaee6db306d352397ba275bc201e5307ccf75a7074c164740faa87e9758cd228a8eddf6266b2a30bdd63a3e29ee066b2f029454bb1823b3e17e10c920f715a24a8eeec7be983360bc4fb05e1d9d63ce98578dd77ac68258abef355f7374f6eb48b1ef837ffd00aa346c3b47a468ce112d76b38e30a04254912bd14ccaed75693607f33b7b6b826376e8b7abbf46dd13beeecbdbd2538654031f0cc3a7c7fceda99ba92dc668b56ad11e0b7e53826ac32cbdddaf09ed80b955f35e5b4484421b89326ba33b1ad41003125701f805dd90631efe012b218a7240d23257a058b03d7b979125d2e08bf4dfd9b04081bede62449702708b1c36fa33339e8ad875065698c6e70e368f828111586d4016a1909b262cf5486eb446a4a4d02c46517cb1f43169341b9908e6b4912932b0533593ab49a11ed115123aebb51b6520f46944d50eed7c750f74b5d6d23888768e430e66c658825388cf5f74fb0502354180556086cded53f23da68ad9c5ccc3d217edbf0d1160e92822fadec3cc2190950cfd4d936387edeec32c5797ff1cecfeaf196817aea4d0718a82dfee967f585ca97ac39952f581951a548a3b68dbfde5eb296d17b8370c8b708f26df3ac6e67f4812cec0d0cea00881922a284d7c73022a5c8f6fcf5faa351a72e53cb4940a8cf548ad59211503a4576179738ea3502caea1a1e4a142be5789b708a0fefd18f271e813448caf5fa48ea6e299458ab88c23adc60dc41daa41d75cef1a251d26a31c45d4252c4751c4a0dd65fbf5d05fbc302b45170b609faa96486177870c09558b15beef6213eb6f819dc1cb4c3be5de2165a08e40df0dfe64cf9f7178fb8289db57386d5667f1ce273b57f2713778a3842a8a7f840eac025aecaf2a1fa02db2f0d258a7a853d2aef58b42a21d46704e3fb57ea88b3b238f47ca1e9a50fccb924a044b58026b5571c7d9a46a4d72a4be35a5a74aae5ba657cea85fab91ee8766070fbb42733bbcfd45d6cbad2125eff187d49c1c604e4f1ac9870dd34fdefcbec6e986214681d95f1cbcdf95e365acdc6f9fe8e636c145b5c7b0cd5b1cfa5e47f61607771919a32750242c1961db397575bfa310e93e518e88921a2de506a141d7d690a65db29fd3f14ed6e1ab687078e37945fdf4711bdbca4fa089b17371c41356c9f81642906ba1e73fce92b83724bd6eea0b89b5d89a7f9b93f8f46002d6710d58e5f649194b953f886d29cebe863237cf98d122afa1a6079fa87bd98cd8f92c5fd7c7e481663009d0171377edd22a9b116402b582e021c7fd5a84f5a7a620f0f8ceb28598401c6e51ac17dad9606795961c54607d6230997ebd22682e3ee2a7eb58ec1bdb0bda144216e518f42729e18baa2037fac00c735f9b60765bddcc9137feb5ac525c1ac5c177e7defc4464b329f8c3a63d4d690c0bf699a0eeefaf9b5df0ef76681f5dad32438a69bfb97596f4fdf3a2565d2ba902da2961cd3a4264457424702ee540bdd320bd223593d0e00c7a551e8965c632317193534f26704b7b1620eef98fe622e8bc7d627364fdbc1b5b86273deabc78a5124166c28a7b918f1b0838bbfbe6a4111d8b4a653bad9ce1ba837e7adbdca63a93af9f6b55c0cb6b008c660b3510c55def9dfc7607edf0d8fc1169e863118db3ea8f3bf8fc1943b7f2b062bdef1db3158e53f0762b0a1f754c4ac5c67ea4fe406e7f6cbe15de74968dc433662e3c6dbf42bbc0c275eddfd013cd0381c2f606b3fbde641f46cbfa2b7a99f5ee3207a777e45af1f2fae7e10bddbbfa2b7a19fde9d41f47ed4de26003a4b10b530bde160b73a5847ede915ee8a20d4be373380efb70dc07cb303986b5518d3d7419aaf5783dd06c95b4f30df5102c03c798285bf37476a01d48e9f040755f4628ab6e233f5e5f4895caed7ea54ff5c9ea31f067a2dfe4eb3d877f50525251a89eec5ff01bdcf7acfe584497bd20540fb5b70cc584174006d35017c9f9b0108a2a2b01aab683a0dd01d67dba5865ec9fcc77d928ce781244d0218af59c0bd993a3012374451236bd11b6e508bd35194772d309b7660e69b3b224e148e3d6236b9c0679788eb56cda46aab4d3fb2f754a1fcb81736603da28aadf5e3ea4a78ce0fafe6a57554424402e73d6ab8cfe5a5b53bcf1dc96a9f1dc98ac224be50429ca43280a4979354689a0d1c84d272603d7984bac29e0490ac1822044792833195f802ce109b71623e455c182237d55aa7dc40cd80dcfcaab0f9cc758bd2503d5c6a12288563464a2c10ce2cd4ce22d05745fb66820aba1684def80c7d39945d0d7c7345c0a66aec1de42f0e0d8c37e0357ebc07068f775ae12bd60955c69a3f237ffd07aab30c47fe6480c2950f388f525dc4736b2c897b7505dabba27b94f21365afe5644babc5489e8a9cec806adecfbd6ca2b0d11f2771de35dc2898a8efd32a6afaca75b8678e14dbe3ae5ab58bf3b5757d16c753dcac275dcec676e061aa5168f73af16e1cba8f5f11db8ecf4b08ad2dc32b1c65b8a90e5315d573be11795cba2a6274302d11658b342aa8f9d7d0f942714c499c84c87e8af843794e76d60c5a4ddd2fc3b9390dd555038af80408a0e68d6e40329846237a34310dddade5ee54f5faafcd496cb672edd97d5b18ebd7839dfb3648f1411960a401200cc6d8e185b208f6c4af0a7195b5025253538fca802b6181c8704f3f1fae1479636b4cf309d536b3e91287b32a354395cbdb2b7817ee87841a952bcd8d42198d45a1db8f1281edb0c40578486263948c7720b40405280207f65d282c9aa73d42744b323a31f30d3d46ef3cbbaf1454347a63134879f1f56e57b200cc346a03c96e73ad11a3f3ce1acbc0f57cb99fa39b08b48d13fdb2538fa9c388df2d9910b56b19e3ad00e5fbe4c5a746ee9a4f28f6c2f6a7dc6c5e35bda571dc573e12b2152fd753ebcb602cdd3a2a6b05b5d682e77849d5ecf9615197e64ca129c222ea063dde88e24eb2dc98916fbae494048ceb70ea619968e0e46871fdd23a442958d7134badb30819329bc41652ef75e0e5ba30d7df2d61c440e04b8859e97e632c9acfee460ee801e552887662242f310731d936fec59e41ef693a34ea81335d7c7d388d4ea27ad87bcf8f610c23d193b84504dcfcc99946b91f8cea8d7a70669f380942fe24904f248134167d3953f33b2f9b85006e12918710c9e6d83e749646286ce36a7a09b53106eafcaec649ccbe5a104602b799468bc80fd261cfdb44601eda4d1b635cd039f01c89c84f78caa889921f87f43f8151616015693b70a517b580d1be68a671f97c4de0fe8b3d610d7d03f7dc91cc3c845443198e222f73ec0a308e3c63dc49862980db19a84b74149aeb15f9e85bca0129c316f7ca00ee0535ce6d9b26bcd0ad5f17d9b1937ec20abd1d47518d34169dd0244d2d37be0fe9ee829b511667bac4a816504b48d7175345ddfe4f02dba35b17b7a0b68f272b4390dc2405b560664118e907fc8d91f3059349a09928d927c4b1f7255e8150830ae6619335819e972464b64b5a983a242d4918e2ec97eb53117482edd344896b762405d7e3c692440ba4175e1059f9385318624032d8f1b88c0c49dbb33044ee3711bbbb795e7a493abeed6e72303d01ce66309ccb363575b76c24ce6ba0fde436cd6c687fb4e18c31471f46462e91fda9cb7c6bb7dbbf73b211f4060bbddc0f990bbd4087b9c7e28402c00373753f3403dc327f6e75422a70defc757fdd0ab48ef5ace8af4d44f02f2bfaeb3310ec78b5bf9efd7aefd1abfdf58508fea9b0bffe3082ad85168b2872c98f2bb332cd8527e1781cdbbbf26fedfee70f39d95cb9b9b01aa037bb0f2c4ef83ad896596d75420d2035f3cbfeba0e109ff9757f1d8145647edf5fe785619989fd75015818d9dd97d85f3b03c24ffae2fbeb55106eed8befaf5f01e1babec3fdf58910aeec3bdc5f9f01e1ecbe0ffbeb690883be0ffbeb0b11dc1bd05f7f18c1dd0103a34270dd042bbbff6f2ac39df3abf860f0fc22eca22844294b8a682259edba82349da533ace69f576eb1f48ba287b5b8dac5ce8a2c96d594da2a1e1aac1b081ad00d040de8068206740341437483a5fa72eddfb9991f42f58d2154df1842f58d215411c469cc8afe5abe97fe7a5ec3faeb398d7a959369cc308dbad17c9e2b1fa6513143342a668846c50cd1a898211a153344a3628669544cbf06f5d7731a14df5fcf6b507f3da74187fbeb390df9b0bf9ed3d00ffbeb390d0be8afe735acbffe24829f4ce8afe735ac5f7a9cfdee3fef8439fbdd7f3262340da3097496cfc7dc9f4e5671ef2e8ac7fbd3e8bb038dcaf9e5c1210b83ce866c65221433f992017db7d4549d1d47efaaec20ac460102a459f9842d4c7d1364e58fb7edcf3b68efff16f76be72f12705a84ce7464b55f5a9c10897d69ed7fc66f59902f6f5653f6b240681b61acefdbcad946bfe75bb6db80b4adc1fc65beec5b64155ce94103d233c691d9dd60192861c76ffb9e954fd1d2ac4c18c5928ee791d675e57f995ff40d6f157f3e6fa84256f293caea84919ec2b6adb0979f92b9f6abcf1b90bed148df46b1ed6f47589c3548e35450e31ad892f386a2d54893c2c8b6be0e6e36fecc7edde3205ba1ddfcc4cff06a54163184e68fb767b075a8268cc4fa7e64e96449aff32de0fc62c8ca69cefa6ff7b0733b77fe00f529971e9c44b8e7e6fd9afab98b5d2707533f376f30f57351a80cd5a11e088c6d7125f5bcb36e70cfff75e5d593a8e777d5033da7d4d02c6e77d4af7beebeb2f7fce09ebba306f7dc3d8c7acb95f12cf5b98b068deb0b31c7497444262a4594510f2c97576f9d65b9997fd1ab6a6bd5de0e4823e5d297155c19eae9a2b48ae16662ae7a00674a4dd659a4737bd5540b8a2c389d4b8a19d039a461fcad222f42c53dc971b1ea168a9c71bec633ac7a170623fa23836fb52cae871132d1e11af0a5414d810e37f6378416622aee7d52716eb9219ae69eebe8727ab1f35b0737f63d225b1ea72befff06225b55aef377e2e794a38890c317f3efbadec10286beedb7c0b10a8eea814e9dad966ceb02e6ef2201d3de2e20c4b4d077f947e0a51d886b4288f83e69e1b06bc06575e5afb0a1ef1642ab58e0aec654e6da326c779e2dcffe849395220bee17aa49e7af47dc174c1662c20560819306ea09d17969071680681142cc82f1723cf480f52c2d65539c9227959ce491a7f1afe3e4ef7c8b38f86ba8f9dd846a302c6816abaa392e97d079d47b6420a6ba53ebfcb250b604c584e82be9dd79b422744507c0023658d0fcf171f61334faa23f9fcfdb5d3c505adcc9959a6bd5e0d6206cbf0e673989750d2a2f7eec2caf01abac83f07f66cb97996bc3c041d8ff9c151df88cc1f45a9df549a07a30bd87ce7223b86321788f1af783b3173dd058c57c29f81e9576cf475a3ef688b3b4b8962b459cd20a748be0558bb3aeee3aaa3ba7ee6267fec822f475371160967a01a415be5027e0aac4d6f8aea0c19716de9fd7a3b21fff8cf62b5916e7990f5786386ae0cb94779d6524f6b5d579e6c372a3bee384eb38b8cd09ffc4c1900e66b03ac75e03e83ccdbf30d5de1a7e4c3f62011ced3b56a7d555f763d70ec3aefc9ec33e37ff53cbafb1edc3b0eb6e38b1bd9e41db310c1b7ce7c49e3c08dbf974b46290e7f8863f335dbe633eba6b38f86bdf9c6cae4eb16cc7fc703dd1c07ab8a5e65a05ec6defbf0c6a6314dc8b95772ee1cad10efcdc372e900ac2098338fb2fed861244901a42cd3fd16a14f781599ef3cd373ab107bdb2f9c87b7e9e2f63f75111a3dd55cef3b3e2ce36c4891fd247b8a39a65fa63d5d60cfe2bfad777eff81fff5a11b24efe64811da17efa1923a136d9b89b36daa79c8d073b239005bc9fd3883fe76783bff9a9ecf6a707df3fe065f97b89e70c50622ca244f5fd37b61cfcb94c708911ed473988fc7d8911b54725dccdccc0fae83af68d03ff759452c9402ef9587c4ab8918ef2b471903a28dce84395eba8e76b813412fd3acdc4df8517b8c48dade6b97e5d1e22ecbfcb96dd89ce5aa2e992043c993bdbf6afe3e8d404206efd8db241dcc6b5f0fcc987f23792e0e5252f37eea0426714a32f8349b856c6ca1a7c3e973d90b5a1ef5b73b26589a6378b1a4ccda637ddecbbeecbe277b4d1a4ec4e4eb667a24fb22cd574cfd35e904431a5c0643751b0059e2535d9765050dfd89d7be9258d7aa65e2202ca5d6ba80387418e345ea5612af4657828e180d469c51d918da9e9455ac3b5c8ad1c68b1f7013ab9ba13854e02ce1877d8d0ce5f7e9a04e81c826df9414db746fda515bd97c0d4bf0f6b70c300923c923a927eda64655b4fec3fc23adc10c6d147ce38b4b853fcc0793b0b748d6de8bfa9f50b562c4b2cb4d16a59837c5600a68974d6289f229907d278327766e693dcb3dc3646d10765d1d06ced59fea5857d07c3f7d4f38bd326e58f877e710b7a9d14e31e8eadeeff827816fa358a212bcf63ee8c0ddd597b3c51d9c6fbf0a7ced6d9f7064650d7323082ca47680486476804c2c1f7ceb89bc60f7c92a9c27a80b8be6ee9a7d5625c0e25afab3f5294d0d3d72f97960d5d03b7829fc58db2adfff734ee0c70506c871c2453fbda7159628f54d6402d6865c7c78e33048d73284f87eafb7bacc78aa533d973d26be80d3e77d24a7fcde3f9b1bf7ac6eaacfa69cf8a70fdb1dc7f94d6ba6902d9775e4fbf9b5f789756233b904f743c4178f2929a27ec1b2bf47c84ec44ba51a4a67c3a011dc89615d776f2efea105446b663202b8656bd311fbdab43ef8a4ee8ffa1700cbcab9b5f6843e7b7f289277f6673ffeb3fb3ad91ef3c226a45efea72b25dd4d4fe52402bd8d27f743ed440bfd9137bc78a7e0d917b0fe55f973620c3c3fc79e8c3224a229d0e63c333c6d149e86c0adb5b12877ee3eae67ccdfb78022e5dc1fec25beeacd015d7f182f9b30b255202c718d3256cefcdf99f5de2bc96a81ef5c24bd33ae8abee5787d615578a1bf8b9a70661ddebff6d39cebfd97a62660e791f6a5253d246e18ff37df58e3e74a22dff7d631dba09cccaef6fb5accf941f26ebfa65fa77f2360606faf5fbd4ab61507f7feec73b4afe38fc7d628695f3eca8356f4b2528ea0d6a096e9a569fb65918e25ccfd1f97a49d2bca4bb6b39ed69ace03427f113631dbbd7f4cb5ac1bf8b6ce656a7fedf96b3b31eb90c9da891dbc2a1df74250a28de5fded9df586ecc8a2d8933b1d285fed9e8b309fea7eeb1ac4acdad2fa9e36ecbac6c42dff0aeae5f53e7fc0ab6f24e501ecf5bb3c4738e737df8bac468a2f8f77eff3296438bdb79358d204db650bd0178525481c8531ea2c04c148ce7c739f85f0f00b71861b65b85b0100fdaa959e4f5f28d82409a1ec1cfdd6146a7c36da6bc3e888357080fe0d27370246e297ae35917f47b5379235d038bd638edb2a4d4bcdae9313e94a2b72044f57b81fc6ff854167325878dce92e20fb8127aafb324fbafc63274ef2e69ed3770ddd3631ca45f1b7e401ef236c6af97d56894821906028d8c2b4b62cba8b432b0c3c690d9d0f377e03077630803081df10bbeb230c6d9e77e9ebf5aae65cd25b4f27e5ab3b84016777a9336cc4050a90ea128a1346ee80d1d3c259ef726da5b7c9c53895a9e74c8a84fd876b63bb59d48ba47adbfbedf835ae764a35f2740bf4c80eed7a177b8837f9d80b7d5cb6875e5e99f42f4a9f7c971ccb800be2ce9c20d68b741065f3729f42d7a8c1ae326e264a45e16aad7031fea82ce87222ed189bc9e320c5d58c6bf3fdbc5f7f10da78d8a57d16f97f81b0b280f6a0f2f47fbc79e36244956b2dcac7d6b84d102a38b3c55a15f8e15cd371e85bd1992174ba3214dd77b47340aec156a7d37ceb8411d72db2f90fe0dd21ef166b47111fb7b647fab2077027f738939bc4e1b36021451876d370a7a628b2afd0f68c35c0123cac6cf6d426b2f7c720b157f8f87ef5fbc5f3b530ca0863eae05c42bfcb8cbc3e1fcecbd44bc82de0fafa79ffd4b06e86d31dbcb26ed793da62ddd0da88c1fc18d8282ca855686de0d82e9e07afe66f6dbda53ee4449a2e6aa847617f037b9b795240a4eee26b4a74600aabd14c88fff0d3875696de1e242fe54292327497b6a37b1879abbd166effc997825c0c2cfd7012439ec1524bba396d753af36e5b697b496b67c55ff4d5d4cf7ca27abdbd7b4ae6d59dfb4d1f91dcf61c958e75c2719af22cbe5f4db4cd484efa7d5f2902e807e41a431212ab93459b4feeedbf3de2979077ff76ecabc0d251bd06f8a5c357273a3db8322ae50fd44cc939251e53b0bd69c4ba3eed50217ca8d62685ac46bfc1e09b4f350dd4e9ce7f7fd50bd0213cc86d1253ba793a7d26f86ef82f3882fce93be0067d7dd7d1393f7b74f8df099d9fde5ba0ad10141853e177c05399d50634a8a10ce2cf0495a5c60b2539e50f3924c76b4e3435657a17f8a5f2d58b33f9428c7c30b5716ca128b3615d5c94316624571d04bb9b22be854c77bee166aac2b589f7b9bdee88c138e648d8bb7b26bc480f7659c712469288716b1ff0b9e7f4d78a14ffcdced3439b74f16cf79f201bf5b9cef6c5546a3568597b855b0262bbc50167f6efbde2f50db1e296a7b6efb7e5b5a9c3004258eceaa54f46b09e8b7139007e67e3fe1585e5a901fc87a9d795d2590bcfe3960babab66341a1db8e0266658780ca16a35b51dba9dd5d38ad1e29be2d45b79b19c3d84a6c912632e00845885d9c2720c539588099a4fb18f1b5cad0b15da0c27054d96ca548b1889142bae2d6edee8baa226dd5643753bb4890b57c6a36dca56e0f4d4fc7987fff22f8b44682fad1da45847aa470b5f4f55d8c5e5a89a919efdf81efdfab3074297bbc3f55875e791ba31a6b45c6007497a72166a7e8d8bea279c78c397acd4262d1790bea45bce8a0c5fdb3fef8731bc755a8673bba4b5569c8cfb088ffc9482f03ea2b12fd4ac27677755564b255a326d4af5a112c56a75ab8f2572d122f1da0de3278f48cd54449961378c56b06bc2756c334e76bde0fcd34e057e8d01d52018a31a877492cc8c8d04ffaa8a43268a124c6d04d7d41c650928c087d4d8f8766eaf18a5c52c048497c9e9eeaae05e5460909b1ed10bba3167aaea63e585240e085f9afefaa086b05aba004bafe40ad681d29c94c07ee97c46af4e50625bce7e6aea646de73a57c5c8124b31ddd4410d482d14289341d705ff5dc95f648b3606bb15242d66d77cfa6feec0006d8e6a9cb6e35257aea4211ae2e59cb1958c7d42f07592bd03c4cd5c4effe462af1ec14acda1db17b7f655ab127f88d1b9dde5d5053c682eaf331b9d1ba957a44d9012065dce149ab6dde8e762c9228599ddb6061ea75008b44b24cb512918b3db12877f5e7d609bd13847bad937f78609dd1cbd5fedd9ad84b5b09f5c1fbccd674e0af3f78911feb887b2e70ac827b2efe7a6453cc56385a15a53b05a51509e219895a0a883c4255417628a1a71550173b5d7c6934ab4068f8a022e62380663d747a3658b18b8132dc7dc9c0d1259e0a21bfa39ee248860c27432d92212385f37d93c4111616094783930f99fa89a0edbcbf3ee2a984d481648bbffef56f6e59b73d9d20fcdc1a0f47e19ead51db4692f7240e4f506575afe4fbc09ee2b00ff229f08aa444ae80881c5b1c10b9a1d73d1bd1d3a8934f0644663c7d6041724132c0a2aa220f9e1f80fe7ef2d9d6fa185a6bcf7209b4d68fb325dbbab66b829a7731af434b1d2566b5991a812cf53de16de9ad5d1231b2532cdaeb48d5e5fe2fe61670f62081565a5100a5c37e6575fe3263bc0c24ac8d4644db6a9e6da31f7ec1daa8eed9367ad5082d54157a651b26d9210554c37557ce4a557e03568a412ba5ad12d64a0f0fb2d2baf0e156bae157561a111dcf5ae942de4a93792b5d38488611d1cfd2664ae80ad2fcc6fd863e67c5620c734388332b8478d7ae6dbb4289023c54970badf5145e4117e20cb4fb92c2630554870e106a5c7a665fd6726c4fa84307e277e3d220a3c4d308347b9096ad624e1544e4970a43ebeb016b8d2b491726d613103ba02d934ffe402d697575da32fa4d062aff9e08eab7e19e8832fd37b64cbaf0b66c5be2f8195a9c81d560cd532195ed2ae46c59b27e25105b16e70672364938c6206b778c815a3cc6f1048b7c91b5c9f01d07adaffc3c41b8cdfaeaed07d66d3f7316f8b525b177c3300b6439cc632d50cb5ae0feff772c90a54bb3fce7430b343ddb0211166b812ee45dc9fa201070f2bfb140215927c91cc75b20db8786b5403d6b81b9832d10d1d3a8bf3fcb592027813b15035a9471f6b1025a59ac24165a995692e9d8ce88eafed09c9fb597bad208884707efa3ddd0f866581a415d6dc4e9284cf18db78408997f3d7fec415fb2b632f47a19406fdfb000c3bf68755ab1149dd8a831d52d6b95fa014c592b3a2cce3dadfb97124fb823ddd3ffab9a23e16cce377c202143e6cf211cca50cf8f80a4c3b1bd27f6636dd6aea55e11bbfbbf618ed4a86f59064e6d9611441de2dc426603dfd733b01e69733ef411a3340af3f20e4c428c05920228d98c8651d89ed1d512423c6bab50a3d6145363c438b4ac7ff69f2788cce40ade16f7cc9e4397c1757c426518a9045df9846ab117fa526bab70e1aef74909d1ba5d92d1b15d225509b25620abebf57c7db76af7fe4b68ccdc290877d68630d1fa9a2d088ded80baee1835d67647daf18b046acaf8fc0a58260d60ef87dd2967df57cc21ca9439d9e534fae560e7fb08f9482edab13bd03959c4688d6af009519cd4a860e3a9073ba8b91bf65eca31f69fac0462a3b9ba9a07fe4dd289e89cf0a307e377a17b61eeba0bbad1f503e735599e8c743a2885b1558eb1c1d2dfaed9d96e62336a87ce27dd759ac87003b54f8773387a3b87a1b38fdfc5d77da01b2203c6381d5c859469618ef18e6530f43dfb9d6b908edbd3347404b74c6b9a592f6ae7cf4dbfe57a48fac94495ac9db7561ba67ffe6ea2c1ce90a49f7caee339933a4b45fdb901f05f5dfdccef066e66ad406f9cd0bb26f7cf245e6120bc503eabda4370849c4a44cdf16e04a1eb3e43e73b53e5b3aefb19a228e977405baa9ebae23d79794d88592405627224595073c6c89f27b5ecb2f1bf9ef02da65a05f7f2312de53bf9fb97f7d00ab5b2c9b95eadae0fdec9ef3f6a38decbbed57e4a026291f613c3f307eb7ebd13e5ef2336c6f35f7adafe991de92b6eef1b290c2cb02d1477536257a00dd3f9c14d3e96f562bc6787a528d233a1278c322a04f28f26621d370465c2a973bc7f8769ffa603a9f99842fc28675f51a4cd94d9a5b5189eb7e51abb5fb5c8a70bc1f7566d59e454ed0c9d475bbe46a1b1c7d039fbee5883e1dfcfad9c450efc7f4418973d0274a612a4a35612608e305be9dc6783aaace5be84b0ff170a06b7b946a036d46a0270dfe389ea075a2abf03555831568cbe54113d38a6f36fde490fb404c4b37a035fa3de02e99dceb34a4fd4f3c057916353a780dc6e9eb3a73db194b8034c53f9aeb8ae240c8d9bc5ec4dc506e7d8f89eea9e39aeb8aba8a7c1e7f983dbb43eb38d5fcdd0369c8d2aae9a28f64eb8367cc7f8fbceff370ba212e78ea8402e651dce5f29bf847e2f0d6a6b9cb3bdfce3b22b8259e8b7f2b1a85042803939e0dace636c9e89dd2cdef9b28bf3e83b96a17c02e1b3f82c3e3794cfa278b94707284a948f867f17be51f5e34239fa1afe15b95707f8f115b9377c4e954be1df6db2e673f1739b8b56cd6d3897287b706e83ace35c86ac27273bfca3bebebfc0f45f30090ff7f5c5c0f457984e94f5f59d82e91b9876c0f4e4485f5f02cc23529293362626f8256ed9b269cb0457f0a748d5bc15ea557ec91bfda252e2d3d6f9bdb2292111f2ea2c670b51d96c88929cee9711bf251d3ea5276ec9d89cfe6cbc944d9b360357c0fdcbd8b82e7e63420aec916dc4b7829ab9694ba25f42c686cdb3fd02d2dc5dc1fcf88cb444bf90b70242a6ce4c796b8a9f6ac9fc7e0856832d89497f0a089996b06a5240da64bf970661fe568d3bcbc2dadfaa9e14b076f214bfff588d282404836c4467783e72f1b3cb9df9be57fe73bd48f99febfd3672f9243e9fc5e74a3e5fc2e7aff1f93a3edfcce7d97cbe83cf4d7c5ecce7a787c195c3e0cff8fc1a9fb7f2f9133e77d9c4e51e7c3e6b18ace4f3057cbe6e18bc7918fcd630387b18bc6318bc87cf4d7c7e64187c7c187c7a185c390cfe6c187c6d187c73185c370c6e1a06b76e1a2acf27c360b07928ec320cde93c2d3e3f323c3e0e3c3e0d3c3e0ca61f067c3e06bc3e09bc3e03a3e6fe273b06128ecc2c31e7c1e320c9ec5e74a3e7f6d181c370c5e370cde3c0c7e6b189ccde73bf8bc78187c64187c7c187c7a185c390cfe6c187c6d187c73185c370c6ee2f3563e77d93814f61806fb0c83d7a687f8a13c6a895f7ae286cd9bb6c46f494e4c43e553fdb8fa697c1ecae7d3f97c069fcfe4f3302e4feba79716bf15ba63e8f892d3a04746cb145bcfd38defc78bdf9294b12171637adaefb724a6676cd9e8b7353e2523d1891fefc49ff62bfcc1886be379fee279fee279fee279fee29dfcf5d359f66cfe783a693c9d349e4e1a4f27cd4967169fbfc8e75343f87c2a278f59ce7e960fc8d56f7e7c4a4ae216b69e6f97ceb74be7dabd9db86513aa5810bf25e185cce42d90435404b6c4fbf9a1f2a59c88e21312b624a6419ed33673e5cbd2e3a937fd366f62573f0827f1e5ea944d6be253062ad2f9f2e5ebb624c6270c2a0fe1cb9fc52cfc07d581ad87eac0e66921bf5fbb19f53b4488bf5fbb257e43e22036401adf6e281e00f17c7f51191ba9f4e44d1bffb316407c9e4efcb4df6a37b40154070e7f3a9fcfe0f3997c1ec68f63dab3f84b03697cfb34be7d1adf3e8d6f9fe66c3f8bcf5fe4f3a9217c3e9593174f279da793ced349e7e9b4cfe2ec50f6229747f2790a9fd7f379019f8f99c3e5e778383aec3fe76be034bfc9ce072797b5f11929e97e6b13d3a97583e0944df10983ebd3d261d8c4c2c9500592a002256f4c4bdf92c18a9c2ddf909c16cf877803c4e0bf18bf490129199361b035db6f100eea004a97dab43511a9747cba5f40c8ac94b782fd521237ce4671d114a4d1b3d9c2297016b8b284f8f4f8d97cfc95c6129a1d303561ca5a482d1d3df9fe2964031f000eebebb7f86007f63f63e459bd0fe97f4078e07fe3abff8daf86c63bff1b5f0d85ffff1e5f4127312774ea06d52077f4c78c74bf4d6bfd36246ed8b4659bbb2be74696bdbe6c7ec4cb2f73f8a11b6207e1a76d4bfb73e25b704f4ca1f538c16fcd363f76571b9092e097999cbe0eed25d13674883f7a46bf2b36a6656c868b7b3af251dbd210354463b65f7cc84b0168871b3f95cfa7a17cc2308aff0fff89b84c38ac98180ce0f8ffb09341ffc8ff3bc882ff63cccbfc7a3a8fcf8bf85c3497cbeff2f9393e8fe2eb97f030f4040083098749f03c94c71f8e030226114c244c2e308961728569044c6e10c71da691308d82c903ec118c86f918d85e02734f987bc1e40d9fa530f93cbf078c85691c4cbe30c9601a0fd373303d0f931f4c1360f287490ed3449802600a844901d3249826c31404d3ef609a02d30b3005c3f47b9842609a0ad3349842619a0ed30c9866c21406d32c985e8469364cff573b761fdb4419c0717ca060d5c410ffd0c618198b9a62a24325a62a22eac0822093552c6fc2a0c58e8d6d7603baa93810a1c00045c40edf10112b2822225644458451e6861315abc2c0b7591110dfb022727e6fbb01fdc5c418498871cff2e9f7eeb9dbedd62edd5daf46375c83eeb8163d38d7eb38cfebe90d348bf6a4bdf85d6f840bbdd10737a12ffae166f6e98f6cdc82013c0f39d4cdb65b39c640dcc6ba07833098f521188a61b89db9e118815c8cc42878e163fb68dc013ff2981b837c14602c0a51d4d17c9b7f20ed4e04508252e6c6613c2620c82b5c8672dc85bb710f2676a84abb17159884c9b80f53f89efb3115d3385e08d3310333518959988d3930bf1ec4dc2e55690f611ecb0f633e1e4118551c6b011ec563781c4fe0492cc45358c47e4f63319ec1123ccb7c04cf612996e179bc80e578112bd8ef25acc4cb588557985f8d5711c56b5883d7b1166fe04dbc8575781bebf10e366023aab109316c460dde452deab005efa11eef632b3ec087f88873d8868f11c7273c439f76ac4afb8ce5edd881065e839d7417fb7f8e2ff025bec2d768c43748e05becc677d883bdd887efb11f3fe047fc849ff10b0ee05724f11b0ee2771cc21f380ca363d31bc000ebad24a739e7675beb6ef361f506c3d880add8857d3884d3361ac639b80857a10f06630c26632e166239d6a20671249084adda30ec70c009173cf02303dde04601ca11c27c2cc64aac473d1ab00707cde36d328cd131c3180f07cb3638e1c2081463222ab10011acc659ec5f4db7a1110770217357a03d7a612016630d6ad180246c9b0de33c38d10743518c4a2cc21a6cc16eacafe167a0116938175de18217e5988b25d88a1588d6347f5f35326a0da30b7a200b0184508ffdb0d5f19c5bdbd2598e5acbe6f685acaf420c1db6f0bbd1bef0633bf6e0505df3bef5c71cd36c77f62fc00294b3cfbcbaa3db63ccd96b9b6559ccb94e194d77fee6ed0c372613d23b6534ff51659ab72c99d981a231be51dc535fd6e5d22b33f37d85de4059a96ff884a2407e4971ee28df91a98b4b4a730bbdb90545852c7af3330bf246722feff3054a8b4a328bb8fe282c0d945d328af76b2607b8fbe7b4fc5ffc8beb0c070f1778cde563ae1f82eedc92fce37c5ea51cb2c43c29c6b8a0bba8383b905714c82b35df871de905dcc9f7ed9de31ede3b6778cf7ed9ee418ef4e26096af20b7cce7354fa62fdb878c0b6697047a7b87a5774eefdc741ce7765e7b74b53a74c7d1f56e1673ce5cb71f230be37736ab44c0e26d38ba6e2e07acedc5c758ba8bbfd3366ddb9ec438d91aed64b4ff9b71cabf1cb6133c5c935aae93d29a2f06db1cb926749a0f53da59d75fed8eecd7342aa65af729d3acebee69a9dbffeba38dd5332eaf5bd6f5ccb18d7b1adaa59d7e42cfa875b48ed6d13a5ac7ff694442d6e77156a3d298342e4d489352dbf4d4daa50ea953ea927aa47e69501a9286a51169541a93c6a50969526a9b915abbd421754a5d528fd42f0d4a43d2b034228d4a63d2b834214d4a6d33536b973aa44ea94bea91faa54169481a9646a451694c1a9726a449a9ad32b576a943ea94baa41ea95f1a9486a46169441a95c6a47169429a94da66a5d62e75489d5297d423f54b83d290342c8d48a3d298342e4d489352dbecd4daa50ea953ea927aa47e69501a9286a51169541a93c6a50969526a9b935abbd421754a5d528fd42f0d4a43d2b034228d4a63d2b834214d4a6d0fa4d62e75489d5297d423f54b83d290342c6d190623ed388ee37dbce3355a3e8f30acd1f2b1c4bac3a756b4ec53b1b7fbd9fff4b87f02f68e0510'
ISP_PROG = binascii.unhexlify(ISP_PROG)
ISP_PROG = zlib.decompress(ISP_PROG)

def printProgressBar (iteration, total, prefix = '', suffix = '', decimals = 1, length = 100, fill = '='):
    """
    Call in a loop to create terminal progress bar
    @params:
        iteration   - Required  : current iteration (Int)
        total       - Required  : total iterations (Int)
        prefix      - Optional  : prefix string (Str)
        suffix      - Optional  : suffix string (Str)
        decimals    - Optional  : positive number of decimals in percent complete (Int)
        length      - Optional  : character length of bar (Int)
        fill        - Optional  : bar fill character (Str)
    """
    percent = ("{0:." + str(decimals) + "f}").format(100 * (iteration / float(total)))
    filledLength = int(length * iteration // total)
    bar = fill * filledLength + '-' * (length - filledLength)
    print('\r%s |%s| %s%% %s' % (prefix, bar, percent, suffix), end = '\r')
    # Print New Line on Complete
    if iteration == total:
        print()

def slip_reader(port):
    partial_packet = None
    in_escape = False

    while True:
        waiting = port.inWaiting()
        read_bytes = port.read(1 if waiting == 0 else waiting)
        if read_bytes == b'':
            raise Exception("Timed out waiting for packet %s" % ("header" if partial_packet is None else "content"))
        for b in read_bytes:

            if type(b) is int:
                b = bytes([b])  # python 2/3 compat

            if partial_packet is None:  # waiting for packet header
                if b == b'\xc0':
                    partial_packet = b""
                else:
                    raise Exception('Invalid head of packet (%r)' % b)
            elif in_escape:  # part-way through escape sequence
                in_escape = False
                if b == b'\xdc':
                    partial_packet += b'\xc0'
                elif b == b'\xdd':
                    partial_packet += b'\xdb'
                else:
                    raise Exception('Invalid SLIP escape (%r%r)' % (b'\xdb', b))
            elif b == b'\xdb':  # start of escape sequence
                in_escape = True
            elif b == b'\xc0':  # end of packet
                yield partial_packet
                partial_packet = None
            else:  # normal byte in packet
                partial_packet += b


class ISPResponse:
    class ISPOperation(Enum):
        ISP_ECHO = 0xC1
        ISP_NOP = 0xC2
        ISP_MEMORY_WRITE = 0xC3
        ISP_MEMORY_READ = 0xC4
        ISP_MEMORY_BOOT = 0xC5
        ISP_DEBUG_INFO = 0xD1

    class ErrorCode(Enum):
        ISP_RET_DEFAULT = 0
        ISP_RET_OK = 0xE0
        ISP_RET_BAD_DATA_LEN = 0xE1
        ISP_RET_BAD_DATA_CHECKSUM = 0xE2
        ISP_RET_INVALID_COMMAND = 0xE3

    @staticmethod
    def parse(data):
        op = data[0]
        reason = data[1]
        text = ''
        try:
            if ISPResponse.ISPOperation(op) == ISPResponse.ISPOperation.ISP_DEBUG_INFO:
                text = data[2:].decode()
        except ValueError:
            print('Warning: recv unknown op', op)

        return (op, reason, text)


class FlashModeResponse:
    class Operation(Enum):
        ISP_DEBUG_INFO = 0xD1
        ISP_NOP = 0xD2
        ISP_FLASH_ERASE = 0xD3
        ISP_FLASH_WRITE = 0xD4
        ISP_REBOOT = 0xD5
        ISP_UARTHS_BAUDRATE_SET = 0xD6
        FLASHMODE_FLASH_INIT = 0xD7

    class ErrorCode(Enum):
        ISP_RET_DEFAULT = 0
        ISP_RET_OK = 0xE0
        ISP_RET_BAD_DATA_LEN = 0xE1
        ISP_RET_BAD_DATA_CHECKSUM = 0xE2
        ISP_RET_INVALID_COMMAND = 0xE3
        ISP_RET_BAD_INITIALIZATION = 0xE4

    @staticmethod
    def parse(data):
        op = data[0]
        reason = data[1]
        text = ''
        if FlashModeResponse.Operation(op) == FlashModeResponse.Operation.ISP_DEBUG_INFO:
            text = data[2:].decode()

        return (op, reason, text)


def chunks(l, n):
    """Yield successive n-sized chunks from l."""
    for i in range(0, len(l), n):
        yield l[i:i + n]


def get_terminal_size(fallback=(100, 24)):
    for i in range(0,3):
        try:
            columns, rows = os.get_terminal_size(i)
        except OSError:
            continue
        break
    else:  # set default if the loop completes which means all failed
        columns, rows = fallback
    return columns, rows

class MAIXLoader:
    def change_baudrate(self, baudrate):
        print(INFO_MSG,"Selected Baudrate: ", baudrate, BASH_TIPS['DEFAULT'])
        out = struct.pack('III', 0, 4, baudrate)
        crc32_checksum = struct.pack('I', binascii.crc32(out) & 0xFFFFFFFF)
        out = struct.pack('HH', 0xd6, 0x00) + crc32_checksum + out
        self.write(out)
        time.sleep(0.05)
        self._port.baudrate = baudrate

    def __init__(self, port='/dev/ttyUSB1', baudrate=115200):
        # configure the serial connections (the parameters differs on the device you are connecting to)
        self._port = serial.Serial(
            port=port,
            baudrate=baudrate,
            parity=serial.PARITY_NONE,
            stopbits=serial.STOPBITS_ONE,
            bytesize=serial.EIGHTBITS,
            timeout=0.1
        )
        print(INFO_MSG, "Default baudrate is", baudrate, ", later it may be changed to the value you set.",  BASH_TIPS['DEFAULT'])

        self._port.isOpen()
        self._slip_reader = slip_reader(self._port)

    """ Read a SLIP packet from the serial port """

    def read(self):
        return next(self._slip_reader)

    """ Write bytes to the serial port while performing SLIP escaping """

    def write(self, packet):
        buf = b'\xc0' \
              + (packet.replace(b'\xdb', b'\xdb\xdd').replace(b'\xc0', b'\xdb\xdc')) \
              + b'\xc0'
        #print('[WRITE]', binascii.hexlify(buf))
        return self._port.write(buf)

    def read_loop(self):
        #out = b''
        # while self._port.inWaiting() > 0:
        #     out += self._port.read(1)

        # print(out)
        while 1:
            sys.stdout.write('[RECV] raw data: ')
            sys.stdout.write(binascii.hexlify(self._port.read(1)).decode())
            sys.stdout.flush()

    def recv_one_return(self):
        timeout_init = time.time()
        data = b''
        # find start boarder
        #sys.stdout.write('[RECV one return] raw data: ')
        while 1:
            if time.time() - timeout_init > timeout:
                # print()
                # print(ERROR_MSG,'Response timeout',BASH_TIPS['DEFAULT'])
                raise TimeoutError
            c = self._port.read(1)
            #sys.stdout.write(binascii.hexlify(c).decode())
            sys.stdout.flush()
            if c == b'\xc0':
                break

        in_escape = False
        while 1:
            if time.time() - timeout_init > timeout:
                raise TimeoutError
            c = self._port.read(1)
            #sys.stdout.write(binascii.hexlify(c).decode())
            sys.stdout.flush()
            if c == b'\xc0':
                break

            elif in_escape:  # part-way through escape sequence
                in_escape = False
                if c == b'\xdc':
                    data += b'\xc0'
                elif c == b'\xdd':
                    data += b'\xdb'
                else:
                    raise Exception('Invalid SLIP escape (%r%r)' % (b'\xdb', c))
            elif c == b'\xdb':  # start of escape sequence
                in_escape = True

            data += c

        #sys.stdout.write('\n')
        return data

    # kd233 or open-ec or new cmsis-dap
    def reset_to_isp_kd233(self):
        self._port.setDTR (False)
        self._port.setRTS (False)
        time.sleep(0.1)
        #print('-- RESET to LOW, IO16 to HIGH --')
        # Pull reset down and keep 10ms
        self._port.setDTR (True)
        self._port.setRTS (False)
        time.sleep(0.1)
        #print('-- IO16 to LOW, RESET to HIGH --')
        # Pull IO16 to low and release reset
        self._port.setRTS (True)
        self._port.setDTR (False)
        time.sleep(0.1)
    def reset_to_boot_kd233(self):
        self._port.setDTR (False)
        self._port.setRTS (False)
        time.sleep(0.1)
        #print('-- RESET to LOW --')
        # Pull reset down and keep 10ms
        self._port.setDTR (True)
        self._port.setRTS (False)
        time.sleep(0.1)
        #print('-- RESET to HIGH, BOOT --')
        # Pull IO16 to low and release reset
        self._port.setRTS (False)
        self._port.setDTR (False)
        time.sleep(0.1)

    #dan dock
    def reset_to_isp_dan(self):
        self._port.setDTR (False)
        self._port.setRTS (False)
        time.sleep(0.1)
        #print('-- RESET to LOW, IO16 to HIGH --')
        # Pull reset down and keep 10ms
        self._port.setDTR (False)
        self._port.setRTS (True)
        time.sleep(0.1)
        #print('-- IO16 to LOW, RESET to HIGH --')
        # Pull IO16 to low and release reset
        self._port.setRTS (False)
        self._port.setDTR (True)
        time.sleep(0.1)
    def reset_to_boot_dan(self):
        self._port.setDTR (False)
        self._port.setRTS (False)
        time.sleep(0.1)
        #print('-- RESET to LOW --')
        # Pull reset down and keep 10ms
        self._port.setDTR (False)
        self._port.setRTS (True)
        time.sleep(0.1)
        #print('-- RESET to HIGH, BOOT --')
        # Pull IO16 to low and release reset
        self._port.setRTS (False)
        self._port.setDTR (False)
        time.sleep(0.1)

    # maix go for old cmsis-dap firmware
    def reset_to_isp_goD(self):
        self._port.setDTR (True)   ## output 0
        self._port.setRTS (True)
        time.sleep(0.01)
        #print('-- RESET to LOW --')
        # Pull reset down and keep 10ms
        self._port.setRTS (False)
        self._port.setDTR (True)
        time.sleep(0.01)
        #print('-- RESET to HIGH, BOOT --')
        # Pull IO16 to low and release reset
        self._port.setRTS (False)
        self._port.setDTR (True)
        time.sleep(0.01)
    def reset_to_boot_goD(self):
        self._port.setDTR (False)
        self._port.setRTS (False)
        time.sleep(0.01)
        #print('-- RESET to LOW --')
        # Pull reset down and keep 10ms
        self._port.setRTS (False)
        self._port.setDTR (True)
        time.sleep(0.01)
        #print('-- RESET to HIGH, BOOT --')
        # Pull IO16 to low and release reset
        self._port.setRTS (True)
        self._port.setDTR (True)
        time.sleep(0.01)

    # maix go for openec or new cmsis-dap  firmware
    def reset_to_boot_maixgo(self):
        self._port.setDTR (False)
        self._port.setRTS (False)
        time.sleep(0.01)
        #print('-- RESET to LOW --')
        # Pull reset down and keep 10ms
        self._port.setRTS (False)
        self._port.setDTR (True)
        time.sleep(0.01)
        #print('-- RESET to HIGH, BOOT --')
        # Pull IO16 to low and release reset
        self._port.setRTS (False)
        self._port.setDTR (False)
        time.sleep(0.01)

    def greeting(self):
        self._port.write(b'\xc0\xc2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc0')
        op, reason, text = ISPResponse.parse(self.recv_one_return())

        #print('MAIX return op:', ISPResponse.ISPOperation(op).name, 'reason:', ISPResponse.ErrorCode(reason).name)


    def flash_greeting(self):
        retry_count = 0
        while 1:
            self._port.write(b'\xc0\xd2\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc0')
            retry_count = retry_count + 1
            try:
                op, reason, text = FlashModeResponse.parse(self.recv_one_return())
            except IndexError:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to Connect to K210's Stub",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Index Error, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue
            except TimeoutError:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to Connect to K210's Stub",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Timeout Error, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue
            except:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to Connect to K210's Stub",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Unexcepted Error, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue
            # print('MAIX return op:', FlashModeResponse.Operation(op).name, 'reason:',
            #      FlashModeResponse.ErrorCode(reason).name)
            if FlashModeResponse.Operation(op) == FlashModeResponse.Operation.ISP_NOP and FlashModeResponse.ErrorCode(reason) == FlashModeResponse.ErrorCode.ISP_RET_OK:
                print(INFO_MSG,"Boot to Flashmode Successfully",BASH_TIPS['DEFAULT'])
                self._port.flushInput()
                self._port.flushOutput()
                break
            else:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to Connect to K210's Stub",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Unexcepted Return recevied, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue

    def boot(self, address=0x80000000):
        print(INFO_MSG,"Booting From " + hex(address),BASH_TIPS['DEFAULT'])

        out = struct.pack('II', address, 0)

        crc32_checksum = struct.pack('I', binascii.crc32(out) & 0xFFFFFFFF)

        out = struct.pack('HH', 0xc5, 0x00) + crc32_checksum + out  # op: ISP_MEMORY_WRITE: 0xc3
        self.write(out)

    def recv_debug(self):
        op, reason, text = ISPResponse.parse(self.recv_one_return())
        #print('[RECV] op:', ISPResponse.ISPOperation(op).name, 'reason:', ISPResponse.ErrorCode(reason).name)
        if text:
            print('-' * 30)
            print(text)
            print('-' * 30)
        if ISPResponse.ErrorCode(reason) not in (ISPResponse.ErrorCode.ISP_RET_DEFAULT, ISPResponse.ErrorCode.ISP_RET_OK):
            print('Failed, retry, errcode=', hex(reason))
            return False
        return True

    def flash_recv_debug(self):
        op, reason, text = FlashModeResponse.parse(self.recv_one_return())
        #print('[Flash-RECV] op:', FlashModeResponse.Operation(op).name, 'reason:',
        #      FlashModeResponse.ErrorCode(reason).name)
        if text:
            print('-' * 30)
            print(text)
            print('-' * 30)

        if FlashModeResponse.ErrorCode(reason) not in (FlashModeResponse.ErrorCode.ISP_RET_OK, FlashModeResponse.ErrorCode.ISP_RET_OK):
            print('Failed, retry')
            return False
        return True

    def init_flash(self, chip_type):
        chip_type = int(chip_type)
        print(INFO_MSG,"Selected Flash: ",("In-Chip", "On-Board")[chip_type],BASH_TIPS['DEFAULT'])
        out = struct.pack('II', chip_type, 0)
        crc32_checksum = struct.pack('I', binascii.crc32(out) & 0xFFFFFFFF)
        out = struct.pack('HH', 0xd7, 0x00) + crc32_checksum + out
        '''Retry when it have error'''
        retry_count = 0
        while 1:
            sent = self.write(out)
            retry_count = retry_count + 1
            try:
                op, reason, text = FlashModeResponse.parse(self.recv_one_return())
            except IndexError:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to initialize flash",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Index Error, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue
            except TimeoutError:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to initialize flash",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Timeout Error, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue
            except:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to initialize flash",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Unexcepted Error, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue
            # print('MAIX return op:', FlashModeResponse.Operation(op).name, 'reason:',
            #      FlashModeResponse.ErrorCode(reason).name)
            if FlashModeResponse.Operation(op) == FlashModeResponse.Operation.FLASHMODE_FLASH_INIT and FlashModeResponse.ErrorCode(reason) == FlashModeResponse.ErrorCode.ISP_RET_OK:
                print(INFO_MSG,"Initialization flash Successfully",BASH_TIPS['DEFAULT'])
                break
            else:
                if retry_count > MAX_RETRY_TIMES:
                    print(ERROR_MSG,"Failed to initialize flash",BASH_TIPS['DEFAULT'])
                    sys.exit(1)
                print(WARN_MSG,"Unexcepted Return recevied, retrying...",BASH_TIPS['DEFAULT'])
                time.sleep(0.1)
                continue

    def flash_dataframe(self, data, address=0x80000000):
        DATAFRAME_SIZE = 1024
        data_chunks = chunks(data, DATAFRAME_SIZE)
        #print('[DEBUG] flash dataframe | data length:', len(data))
        total_chunk = math.ceil(len(data)/DATAFRAME_SIZE)

        time_start = time.time()
        for n, chunk in enumerate(data_chunks):
            while 1:
                #print('[INFO] sending chunk', i, '@address', hex(address), 'chunklen', len(chunk))
                out = struct.pack('II', address, len(chunk))

                crc32_checksum = struct.pack('I', binascii.crc32(out + chunk) & 0xFFFFFFFF)

                out = struct.pack('HH', 0xc3, 0x00) + crc32_checksum + out + chunk  # op: ISP_MEMORY_WRITE: 0xc3
                sent = self.write(out)
                #print('[INFO]', 'sent', sent, 'bytes', 'checksum', binascii.hexlify(crc32_checksum).decode())

                address += len(chunk)

                if self.recv_debug():
                    break

            columns, lines = get_terminal_size()
            time_delta = time.time() - time_start
            speed = ''
            if (time_delta > 1):
                speed = str(int((n + 1) * DATAFRAME_SIZE / 1024.0 / time_delta)) + 'kiB/s'
            printProgressBar(n+1, total_chunk, prefix = 'Downloading ISP:', suffix = speed, length = columns - 35)

    def dump_to_flash(self, data, address=0):
        '''
        typedef struct __attribute__((packed)) {
            uint8_t op;
            int32_t checksum; // checksum
            uint32_t address;
            uint32_t data_len;
            uint8_t data_buf[1024];
        } isp_request_t;
        '''

        DATAFRAME_SIZE = ISP_FLASH_DATA_FRAME_SIZE
        data_chunks = chunks(data, DATAFRAME_SIZE)
        #print('[DEBUG] flash dataframe | data length:', len(data))



        for n, chunk in enumerate(data_chunks):
            #print('[INFO] sending chunk', i, '@address', hex(address))
            out = struct.pack('II', address, len(chunk))

            crc32_checksum = struct.pack('I', binascii.crc32(out + chunk) & 0xFFFFFFFF)

            out = struct.pack('HH', 0xd4, 0x00) + crc32_checksum + out + chunk
            #print("[$$$$]", binascii.hexlify(out[:32]).decode())
            retry_count = 0
            while True:
                try:
                    sent = self.write(out)
                    #print('[INFO]', 'sent', sent, 'bytes', 'checksum', crc32_checksum)
                    self.flash_recv_debug()
                except:
                    retry_count = retry_count + 1
                    if retry_count > MAX_RETRY_TIMES:
                        print(ERROR_MSG,"Error Count Exceeded, Stop Trying",BASH_TIPS['DEFAULT'])
                        sys.exit(1)
                    continue
                break
            address += len(chunk)



    def flash_erase(self):
        #print('[DEBUG] erasing spi flash.')
        self._port.write(b'\xc0\xd3\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xc0')
        op, reason, text = FlashModeResponse.parse(self.recv_one_return())
        #print('MAIX return op:', FlashModeResponse.Operation(op).name, 'reason:',
        #      FlashModeResponse.ErrorCode(reason).name)

    def install_flash_bootloader(self, data):
        # 1.  flash bootloader
        self.flash_dataframe(data, address=0x80000000)

    def load_elf_to_sram(self, f):
        from elftools.elf.elffile import ELFFile
        from elftools.elf.descriptions import describe_p_type

        elffile = ELFFile(f)
        if elffile['e_entry'] != 0x80000000:
            print(WARN_MSG,"ELF entry is 0x%x instead of 0x80000000" % (elffile['e_entry']), BASH_TIPS['DEFAULT'])

        for segment in elffile.iter_segments():
            t = describe_p_type(segment['p_type'])
            print(INFO_MSG, ("Program Header: Size: %d, Virtual Address: 0x%x, Type: %s" % (segment['p_filesz'], segment['p_vaddr'], t)), BASH_TIPS['DEFAULT'])
            if not (segment['p_vaddr'] & 0x80000000):
                continue
            if segment['p_filesz']==0 or segment['p_vaddr']==0:
                print("Skipped")
                continue
            self.flash_dataframe(segment.data(), segment['p_vaddr'])

    def flash_firmware(self, firmware_bin: bytes, aes_key: bytes = None, address_offset = 0, sha256Prefix = True):
        #print('[DEBUG] flash_firmware DEBUG: aeskey=', aes_key)

        if sha256Prefix == True:
            # 
            # : SHA256(after)(32bytes) + AES_CIPHER_FLAG (1byte) + firmware_size(4bytes) + firmware_data
            aes_cipher_flag = b'\x01' if aes_key else b'\x00'

            # 
            if aes_key:
                enc = AES_128_CBC(aes_key, iv=b'\x00'*16).encrypt
                padded = firmware_bin + b'\x00'*15 # zero pad
                firmware_bin = b''.join([enc(padded[i*16:i*16+16]) for i in range(len(padded)//16)])

            firmware_len = len(firmware_bin)

            data = aes_cipher_flag + struct.pack('I', firmware_len) + firmware_bin

            sha256_hash = hashlib.sha256(data).digest()

            firmware_with_header = data + sha256_hash

            total_chunk = math.ceil(len(firmware_with_header)/ISP_FLASH_DATA_FRAME_SIZE)
            # 3. 
            data_chunks = chunks(firmware_with_header, ISP_FLASH_DATA_FRAME_SIZE)  # 4kiB for a sector, 16kiB for dataframe
        else:
            total_chunk = math.ceil(len(firmware_bin)/ISP_FLASH_DATA_FRAME_SIZE)
            data_chunks = chunks(firmware_bin, ISP_FLASH_DATA_FRAME_SIZE)

        time_start = time.time()
        for n, chunk in enumerate(data_chunks):
            chunk = chunk.ljust(ISP_FLASH_DATA_FRAME_SIZE, b'\x00')  # align by size of dataframe

            # 3.1 dataframe
            #print('[INFO]', 'Write firmware data piece')
            self.dump_to_flash(chunk, address= n * ISP_FLASH_DATA_FRAME_SIZE + address_offset)
            columns, lines = get_terminal_size()
            time_delta = time.time() - time_start
            speed = ''
            if (time_delta > 1):
                speed = str(int((n + 1) * ISP_FLASH_DATA_FRAME_SIZE / 1024.0 / time_delta)) + 'kiB/s'
            printProgressBar(n+1, total_chunk, prefix = 'Programming BIN:', suffix = speed, length = columns - 35)

def open_terminal(reset):
    control_signal = '0' if reset else '1'
    control_signal_b = not reset
    import serial.tools.miniterm
    # For using the terminal with MaixPy the 'filter' option must be set to 'direct'
    # because some control characters are emited
    sys.argv = ['kflash.py', _port, '115200', '--dtr='+control_signal, '--rts='+control_signal,  '--filter=direct']
    serial.tools.miniterm.main(default_port=_port, default_baudrate=115200, default_dtr=control_signal_b, default_rts=control_signal_b)
    sys.exit(0)

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument("-p", "--port", help="COM Port", default="DEFAULT")
    parser.add_argument("-c", "--chip", help="SPI Flash type, 0 for in-chip, 1 for on-board", default=1)
    parser.add_argument("-b", "--baudrate", type=int, help="UART baudrate for uploading firmware", default=115200)
    parser.add_argument("-l", "--bootloader", help="bootloader bin path", required=False, default=None)
    parser.add_argument("-k", "--key", help="AES key in hex, if you need encrypt your firmware.", required=False, default=None)
    parser.add_argument("-v", "--verbose", help="increase output verbosity", default=False, action="store_true")
    parser.add_argument("-t", "--terminal", help="Start a terminal after finish (Python miniterm)", default=False, action="store_true")
    parser.add_argument("-n", "--noansi", help="Do not use ANSI colors, recommended in Windows CMD", default=False, action="store_true")
    parser.add_argument("-s", "--sram", help="Download firmware to SRAM and boot", default=False, action="store_true")

    parser.add_argument("-B", "--Board",required=False, type=str, help="Select dev board, e.g. kd233, dan, bit, goD, goE or trainer")
    parser.add_argument("firmware", help="firmware bin path")

    args = parser.parse_args()

    if (args.noansi == True):
        BASH_TIPS = dict(NORMAL='',BOLD='',DIM='',UNDERLINE='',
                            DEFAULT='', RED='', YELLOW='', GREEN='',
                            BG_DEFAULT='', BG_WHITE='')
        ERROR_MSG   = BASH_TIPS['RED']+BASH_TIPS['BOLD']+'[ERROR]'+BASH_TIPS['NORMAL']
        WARN_MSG    = BASH_TIPS['YELLOW']+BASH_TIPS['BOLD']+'[WARN]'+BASH_TIPS['NORMAL']
        INFO_MSG    = BASH_TIPS['GREEN']+BASH_TIPS['BOLD']+'[INFO]'+BASH_TIPS['NORMAL']
        print(INFO_MSG,'ANSI colors not used',BASH_TIPS['DEFAULT'])

    if args.port == "DEFAULT":
        if args.Board == "goE":
            list_port_info = list(serial.tools.list_ports.grep("0403")) #Take the second one
            if(len(list_port_info)==0):
                print(ERROR_MSG,"No vaild COM Port found in Auto Detect, Check Your Connection or Specify One by"+BASH_TIPS['GREEN']+'`--port/-p`',BASH_TIPS['DEFAULT'])
                sys.exit(1)
            list_port_info.sort()
            _port = list_port_info[1].device
            print(INFO_MSG,"COM Port Auto Detected, Selected ", _port, BASH_TIPS['DEFAULT'])
        elif args.Board == "trainer":
            list_port_info = list(serial.tools.list_ports.grep("0403")) #Take the first one
            if(len(list_port_info)==0):
                print(ERROR_MSG,"No vaild COM Port found in Auto Detect, Check Your Connection or Specify One by"+BASH_TIPS['GREEN']+'`--port/-p`',BASH_TIPS['DEFAULT'])
                sys.exit(1)
            list_port_info.sort()
            _port = list_port_info[0].device
            print(INFO_MSG,"COM Port Auto Detected, Selected ", _port, BASH_TIPS['DEFAULT'])
        else:
            try:
                list_port_info = next(serial.tools.list_ports.grep(VID_LIST_FOR_AUTO_LOOKUP)) #Take the first one within the list
                _port = list_port_info.device
                print(INFO_MSG,"COM Port Auto Detected, Selected ", _port, BASH_TIPS['DEFAULT'])
            except StopIteration:
                print(ERROR_MSG,"No vaild COM Port found in Auto Detect, Check Your Connection or Specify One by"+BASH_TIPS['GREEN']+'`--port/-p`',BASH_TIPS['DEFAULT'])
                sys.exit(1)
    else:
        _port = args.port
        print(INFO_MSG,"COM Port Selected Manually: ", _port, BASH_TIPS['DEFAULT'])

    loader = MAIXLoader(port=_port, baudrate=115200)
    file_format = ProgramFileFormat.FMT_BINARY

    # 0. Check firmware
    try:
        firmware_bin = open(args.firmware, 'rb')
    except FileNotFoundError:
        print(ERROR_MSG,'Unable to find the firmware at ', args.firmware, BASH_TIPS['DEFAULT'])
        sys.exit(1)

    with open(args.firmware, 'rb') as f:
        file_header = f.read(4)
        if file_header.startswith(bytes([0x50, 0x4B])):
            if ".kfpkg" != os.path.splitext(args.firmware)[1]:
                print(INFO_MSG, 'Find a zip file, but not with ext .kfpkg:', args.firmware, BASH_TIPS['DEFAULT'])
            else:
                file_format = ProgramFileFormat.FMT_KFPKG

        if file_header.startswith(bytes([0x7F, 0x45, 0x4C, 0x46])):
            file_format = ProgramFileFormat.FMT_ELF
            if args.sram:
                print(INFO_MSG, 'Find an ELF file:', args.firmware, BASH_TIPS['DEFAULT'])
            else:
                print(ERROR_MSG, 'This is an ELF file and cannot be programmed directly:', args.firmware, BASH_TIPS['DEFAULT'])
                print(ERROR_MSG, 'Please retry:', args.firmware + '.bin', BASH_TIPS['DEFAULT'])
                sys.exit(1)

    # 1. Greeting.
    print(INFO_MSG,"Trying to Enter the ISP Mode...",BASH_TIPS['DEFAULT'])

    retry_count = 0

    while 1:
        retry_count = retry_count + 1
        if retry_count > 15:
            print("\n" + ERROR_MSG,"No vaild Kendryte K210 found in Auto Detect, Check Your Connection or Specify One by"+BASH_TIPS['GREEN']+'`-p '+('/dev/ttyUSB0', 'COM3')[sys.platform == 'win32']+'`',BASH_TIPS['DEFAULT'])
            sys.exit(1)
        if args.Board == "dan" or args.Board == "bit" or args.Board == "trainer":
            try:
                print('.', end='')
                loader.reset_to_isp_dan()
                loader.greeting()
                break
            except TimeoutError:
                pass
        elif args.Board == "kd233":
            try:
                print('_', end='')
                loader.reset_to_isp_kd233()
                loader.greeting()
                break
            except TimeoutError:
                pass
        elif args.Board == "goE":
            try:
                print('*', end='')
                loader.reset_to_isp_kd233()
                loader.greeting()
                break
            except TimeoutError:
                pass
        elif args.Board == "goD":
            try:
                print('#', end='')
                loader.reset_to_isp_goD()
                loader.greeting()
                break
            except TimeoutError:
                pass
        else:
            try:
                print('.', end='')
                loader.reset_to_isp_dan()
                loader.greeting()
                args.Board = "dan"
                print()
                print(INFO_MSG,"Automatically detected dan/bit/trainer",BASH_TIPS['DEFAULT'])
                break
            except TimeoutError:
                pass
            try:
                print('_', end='')
                loader.reset_to_isp_kd233()
                loader.greeting()
                args.Board = "kd233"
                print()
                print(INFO_MSG,"Automatically detected goE/kd233",BASH_TIPS['DEFAULT'])
                break
            except TimeoutError:
                pass
            try:
                print('.', end='')
                loader.reset_to_isp_goD()
                loader.greeting()
                args.Board = "goD"
                print()
                print(INFO_MSG,"Automatically detected goD",BASH_TIPS['DEFAULT'])
                break
            except TimeoutError:
                pass
            try:
                # Magic, just repeat, don't remove, it may unstable, don't know why.
                print('_', end='')
                loader.reset_to_isp_kd233()
                loader.greeting()
                args.Board = "kd233"
                print()
                print(INFO_MSG,"Automatically detected goE/kd233",BASH_TIPS['DEFAULT'])
                break
            except TimeoutError:
                pass
    timeout = 3
    print()
    print(INFO_MSG,"Greeting Message Detected, Start Downloading ISP",BASH_TIPS['DEFAULT'])
    # 2. flash bootloader and firmware

    if args.sram:
        if file_format == ProgramFileFormat.FMT_KFPKG:
            print(ERROR_MSG, "Unable to load kfpkg to SRAM")
            sys.exit(1)
        elif file_format == ProgramFileFormat.FMT_ELF:
            loader.load_elf_to_sram(firmware_bin)
        else:
            loader.install_flash_bootloader(firmware_bin.read())
    else:
        # install bootloader at 0x80000000
        isp_loader = open(args.bootloader, 'rb').read() if args.bootloader else ISP_PROG
        loader.install_flash_bootloader(isp_loader)
    loader.boot()

    if args.sram:
        if(args.terminal == True):
            open_terminal(False)

    print(INFO_MSG,"Wait For 0.1 second for ISP to Boot", BASH_TIPS['DEFAULT'])

    time.sleep(0.1)

    loader.flash_greeting()

    if args.baudrate != 115200:
        loader.change_baudrate(args.baudrate)
        print(INFO_MSG,"Baudrate changed, greeting with ISP again ... ", BASH_TIPS['DEFAULT'])
        loader.flash_greeting()

    loader.init_flash(args.chip)

    if file_format == ProgramFileFormat.FMT_KFPKG:
        print(INFO_MSG,"Extracting KFPKG ... ", BASH_TIPS['DEFAULT'])
        firmware_bin.close()
        with tempfile.TemporaryDirectory() as tmpdir:
            try:
                with zipfile.ZipFile(args.firmware) as zf:
                    zf.extractall(tmpdir)
            except zipfile.BadZipFile:
                print(ERROR_MSG,'Unable to Decompress the kfpkg, your file might be corrupted.',BASH_TIPS['DEFAULT'])
                sys.exit(1)

            fFlashList = open(os.path.join(tmpdir, 'flash-list.json'), "r")
            sFlashList = re.sub(r'"address": (.*),', r'"address": "\1",', fFlashList.read()) #Pack the Hex Number in json into str
            fFlashList.close()
            jsonFlashList = json.loads(sFlashList)
            for lBinFiles in jsonFlashList['files']:
                print(INFO_MSG,"Writing",lBinFiles['bin'],"into","0x%08x"%int(lBinFiles['address'], 0),BASH_TIPS['DEFAULT'])
                firmware_bin = open(os.path.join(tmpdir, lBinFiles["bin"]), "rb")
                loader.flash_firmware(firmware_bin.read(), None, int(lBinFiles['address'], 0), lBinFiles['sha256Prefix'])
                firmware_bin.close()
    else:
        if args.key:
            aes_key = binascii.a2b_hex(args.key)
            if len(aes_key) != 16:
                raise ValueError('AES key must by 16 bytes')

            loader.flash_firmware(firmware_bin.read(), aes_key=aes_key)
        else:
            loader.flash_firmware(firmware_bin.read())

    # 3. boot
    if args.Board == "dan" or args.Board == "bit" or args.Board == "trainer":
        loader.reset_to_boot_dan()
    elif args.Board == "kd233":
        loader.reset_to_boot_kd233()
    elif args.Board == "goE":
        loader.reset_to_boot_maixgo()
    elif args.Board == "goD":
        loader.reset_to_boot_goD()
    else:
        print(WARN_MSG,"Board unknown !! please press reset to boot!!")

    print(INFO_MSG,"Rebooting...", BASH_TIPS['DEFAULT'])
    loader._port.close()

    if(args.terminal == True):
        open_terminal(True)